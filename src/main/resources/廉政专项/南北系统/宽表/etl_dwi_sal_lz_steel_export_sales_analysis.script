{
	"configuration":{},
	"connectionName":"MRS_Spark_Agent",
	"content":"-- ******************************************************************** --\n-- author: jh_caiyi\n-- create time: 2025-07-15\n-- descr: 廉政八项-南北系统专线-销售出口分析 - 支持客商、价格、销量、提货、运输统计分析\n-- ******************************************************************** --\n-- DROP TABLE IF EXISTS dwi_sal.dwi_sal_lz_steel_export_sales_analysis;\n-- CREATE TABLE\n--     dwi_sal.dwi_sal_lz_steel_export_sales_analysis (\n--     -- 单据关联维度\n--     salshipgicode VARCHAR(50),                -- 发货商品子项ID主键\n--     salshipicode VARCHAR(50),                 -- 销售发货单内码外键\n--     salordicodex VARCHAR(50),                 -- 销售合同核销内码\n--     salordcodex VARCHAR(50),                  -- 销售合同核销号\n--     salordgicodex VARCHAR(50),                -- 销售合同商品明细核销内码\n--     salordercode VARCHAR(50),                 -- 客户订单号\n--     prjcode VARCHAR(50),                      -- 项目号\n--     prjicode VARCHAR(50),                     -- 项目号内码\n--     salgdelplanicodex VARCHAR(50),            -- 合同交期计划核销内码\n    \n--     -- 客商维度\n--     ccode VARCHAR(50),                        -- 客户\n--     grpccode VARCHAR(50),                     -- 公司客商\n--     ccodetrust VARCHAR(50),                   -- 委托方\n--     grpccodetrust VARCHAR(50),                -- 委托方公司客商\n--     supccode VARCHAR(50),                     -- 供应商\n--     grpsupccode VARCHAR(50),                  -- 供应商公司客商\n    \n--     -- 商品维度\n--     gicode VARCHAR(50),                       -- 商品分类内码\n--     gcode VARCHAR(50),                        -- 基础的商品大类码\n--     gcodesumdesc VARCHAR(200),                -- 商品级次\n--     gvicode VARCHAR(50),                      -- 商品级次内码\n--     gcodedesc VARCHAR(200),                   -- 商品描述\n--     cgcodesal VARCHAR(50),                    -- 客户货号\n--     specifidesc VARCHAR(200),                 -- 型号规格\n--     rgcode VARCHAR(50),                       -- 真实物料号\n--     engcodedesc VARCHAR(200),                 -- 英文品名\n--     cngcodedesc VARCHAR(200),                 -- 中文品名\n    \n--     -- 组织维度\n--     bcode VARCHAR(50),                        -- 业务组织\n--     corpbcode VARCHAR(50),                    -- 法人组织\n--     keptbcode VARCHAR(50),                    -- 记帐部门\n--     wcode VARCHAR(50),                        -- 属主人员\n--     jcode VARCHAR(50),                        -- 核算组\n    \n--     -- 时间维度\n--     deliverydate VARCHAR(50),                   -- 交货日期\n--     etd VARCHAR(50),                            -- 预计发货日期\n    \n--     -- 贸易维度\n--     tradetype VARCHAR(50),                    -- 贸易类型\n--     trademode VARCHAR(50),                    -- 贸易方式\n--     busimode VARCHAR(50),                     -- 经营方式\n--     psmode VARCHAR(50),                       -- 销售模式\n--     loadingport VARCHAR(50),                  -- 装货港\n--     loadingportdesc VARCHAR(200),             -- 装货港描述\n--     dischargeport VARCHAR(50),                -- 卸货港\n--     dischargeportdesc VARCHAR(200),           -- 卸货港描述\n--     busitype VARCHAR(50),                     -- 业务类型\n--     htype VARCHAR(50),                        -- 合同类型\n--     issample VARCHAR(50),                         -- 是否为样品\n--     isbacktax VARCHAR(50),                        -- 是否退税\n    \n--     -- 数量指标\n--     qtc DECIMAL(32,6),                        -- 单据数量\n--     qtcunit VARCHAR(50),                      -- 单据数量单位\n--     qty DECIMAL(32,6),                        -- 标准库存数量\n--     qtyunit VARCHAR(50),                      -- 标准库存单位\n--     qtx DECIMAL(32,6),                        -- 包装数量\n--     qtxunit VARCHAR(50),                      -- 包装数量单位\n--     grossweight DECIMAL(32,6),                -- 毛重\n--     netweight DECIMAL(32,6),                  -- 净重\n--     volume DECIMAL(32,6),                     -- 总体积M3\n--     stockoutqtc DECIMAL(32,6),                -- 出库单据数量\n--     stockoutqtx DECIMAL(32,6),                -- 出库包装数量\n--     stockoutqty DECIMAL(32,6),                -- 出库统计数量\n--     stockoutqts DECIMAL(32,6),                -- 出库库存数量\n    \n--     -- 价格指标\n--     upric DECIMAL(32,6),                      -- 标准数量单价\n--     fcode VARCHAR(50),                        -- 原币币种\n--     sfcode VARCHAR(50),                       -- 本位币种\n--     fcy DECIMAL(32,6),                        -- 原币金额\n--     scy DECIMAL(32,6),                        -- 折本位币金额\n--     rcy1 DECIMAL(32,6),                       -- 折报告币1金额\n--     rcy2 DECIMAL(32,6),                       -- 折报告币2金额\n--     natfcy DECIMAL(32,6),                     -- 不含税金额原币金额\n--     natscy DECIMAL(32,6),                     -- 不含税金额原币折本位币金额\n--     natrcy1 DECIMAL(32,6),                    -- 不含税金额原币折RMB金额\n--     natrcy2 DECIMAL(32,6),                    -- 不含税金额原币折USD金额\n--     natupric DECIMAL(32,6),                   -- 不含税金额单价\n--     fobfcy DECIMAL(32,6),                     -- FOB原币金额\n--     fobscy DECIMAL(32,6),                     -- FOB原币折本位币金额\n--     fobrcy1 DECIMAL(32,6),                    -- FOB原币折RMB金额\n--     fobrcy2 DECIMAL(32,6),                    -- FOB原币折USD金额\n--     ciffcy DECIMAL(32,6),                     -- CIF原币金额\n--     cifscy DECIMAL(32,6),                     -- CIF原币折本位币金额\n--     cifrcy1 DECIMAL(32,6),                    -- CIF原币折RMB金额\n--     cifrcy2 DECIMAL(32,6),                    -- CIF原币折USD金额\n--     advupric DECIMAL(32,6),                   -- 建议单价\n--     pupric DECIMAL(32,6),                     -- 定价单价\n    \n--     -- 成本利润指标\n--     purupric DECIMAL(32,6),                   -- 采购含税单价\n--     purfcy DECIMAL(32,6),                     -- 采购原币金额\n--     purscy DECIMAL(32,6),                     -- 采购本位币金额\n--     purrcy1 DECIMAL(32,6),                    -- 采购人民币金额\n--     purrcy2 DECIMAL(32,6),                    -- 采购美元金额\n--     purnatfcy DECIMAL(32,6),                  -- 采购不含税原币金额\n--     purnatscy DECIMAL(32,6),                  -- 采购不含税本位币金额\n--     purnatrcy1 DECIMAL(32,6),                 -- 采购不含税人民币金额\n--     purnatrcy2 DECIMAL(32,6),                 -- 采购不含税美元金额\n--     profitrate DECIMAL(32,6),                 -- 利润率\n--     profitfcy DECIMAL(32,6),                  -- 原币利润\n--     profitscy DECIMAL(32,6),                  -- 本币利润\n--     profitrcy1 DECIMAL(32,6),                 -- 人民币利润\n--     profitrcy2 DECIMAL(32,6),                 -- 美元利润\n--     unitprofitfcy DECIMAL(32,6),              -- 单品原币利润\n--     unitprofitscy DECIMAL(32,6),              -- 单品本币利润\n--     unitprofitrcy1 DECIMAL(32,6),             -- 单品人民币利润\n--     unitprofitrcy2 DECIMAL(32,6),             -- 单品美元利润\n--     costfcy DECIMAL(32,6),                    -- 成本原币金额\n--     costscy DECIMAL(32,6),                    -- 成本本位币金额\n--     costrcy1 DECIMAL(32,6),                   -- 成本人民币金额\n--     costrcy2 DECIMAL(32,6),                   -- 成本美元金额\n    \n--     -- 运输指标\n--     freightfcode VARCHAR(50),                 -- 运费币种\n--     freightfcy DECIMAL(32,6),                 -- 运费原币金额\n--     freightscy DECIMAL(32,6),                 -- 运费原币折本位币金额\n--     freightrcy1 DECIMAL(32,6),                -- 运费原币折RMB金额\n--     freightrcy2 DECIMAL(32,6),                -- 运费原币折USD金额\n--     freupric DECIMAL(32,6),                   -- 运费单价\n--     freightocy DECIMAL(32,6),                 -- 运费合同币金额\n--     insurancefcy DECIMAL(32,6),               -- 保费原币金额\n--     insurancescy DECIMAL(32,6),               -- 保费原币折本位币金额\n--     insurancercy1 DECIMAL(32,6),              -- 保费原币折RMB金额\n--     insurancercy2 DECIMAL(32,6),              -- 保费原币折USD金额\n    \n--     -- 税费指标\n--     addtaxrate DECIMAL(32,6),                 -- 增值税税率\n--     addtaxscy DECIMAL(32,6),                  -- 增值税原币折本位币金额\n--     addtaxrcy1 DECIMAL(32,6),                 -- 增值税原币折RMB金额\n--     addtaxrcy2 DECIMAL(32,6),                 -- 增值税原币折USD金额\n--     customrate DECIMAL(32,6),                 -- 关税税率\n--     customscy DECIMAL(32,6),                  -- 关税原币折本位币金额\n--     customrcy1 DECIMAL(32,6),                 -- 关税原币折RMB金额\n--     customrcy2 DECIMAL(32,6),                 -- 关税原币折USD金额\n--     expcustomrate DECIMAL(32,6),              -- 出口关税率\n--     customaddtaxscy DECIMAL(32,6),            -- 国际贸易增值税本位币金额\n--     customaddtaxrcy1 DECIMAL(32,6),           -- 国际贸易增值税报告币1金额\n--     customaddtaxrcy2 DECIMAL(32,6),           -- 国际贸易增值税报告币2币金额\n--     customaddtaxrate DECIMAL(32,6),           -- 国际贸易增值税率\n    \n--     -- 佣金指标\n--     cmsfcy DECIMAL(32,6),                     -- 佣金原币金额\n--     cmsscy DECIMAL(32,6),                     -- 佣金本币金额\n--     cmsrcy1 DECIMAL(32,6),                    -- 佣金折报告币1金额\n--     cmsrcy2 DECIMAL(32,6),                    -- 佣金折报告币2金额\n--     cmsrate DECIMAL(32,6),                    -- 佣金率合计\n--     cmsmethod VARCHAR(50)                    -- 佣金计算方法\n--     )\n-- COMMENT '廉政八项-南北系统专线-销售出口分析 - 支持客商、价格、销量、提货、运输统计分析'\n-- PARTITIONED BY (mt STRING COMMENT '分区月份')\n-- STORED AS ORC;\n \nINSERT OVERWRITE TABLE dwi_sal.dwi_sal_lz_steel_export_sales_analysis PARTITION (mt='2025-07')\nSELECT\n    -- 单据关联维度\n    d.salshipgicode,                -- 发货商品子项ID主键\n    d.salshipicode,                 -- 销售发货单内码外键\n    d.salordicodex,                 -- 销售合同核销内码\n    d.salordcodex,                  -- 销售合同核销号\n    d.salordgicodex,                -- 销售合同商品明细核销内码\n    d.salordercode,                 -- 客户订单号\n    d.prjcode,                      -- 项目号\n    d.prjicode,                     -- 项目号内码\n    d.salgdelplanicodex,            -- 合同交期计划核销内码\n    \n    -- 客商维度\n    d.ccode,                        -- 客户\n    d.grpccode,                     -- 公司客商\n    d.ccodetrust,                   -- 委托方\n    d.grpccodetrust,                -- 委托方公司客商\n    d.supccode,                     -- 供应商\n    d.grpsupccode,                  -- 供应商公司客商\n    \n    -- 商品维度\n    d.gicode,                       -- 商品分类内码\n    d.gcode,                        -- 基础的商品大类码\n    d.gcodesumdesc,                 -- 商品级次\n    d.gvicode,                      -- 商品级次内码\n    d.gcodedesc,                    -- 商品描述\n    d.cgcodesal,                    -- 客户货号\n    d.specifidesc,                  -- 型号规格\n    d.rgcode,                       -- 真实物料号\n    d.engcodedesc,                  -- 英文品名\n    d.cngcodedesc,                  -- 中文品名\n    \n    -- 组织维度\n    d.bcode,                        -- 业务组织\n    d.corpbcode,                    -- 法人组织\n    d.keptbcode,                    -- 记帐部门\n    d.wcode,                        -- 属主人员\n    d.jcode,                        -- 核算组\n    \n    -- 时间维度\n    d.deliverydate,                 -- 交货日期\n    d.etd,                          -- 预计发货日期\n    \n    -- 贸易维度\n    d.tradetype,                    -- 贸易类型\n    d.trademode,                    -- 贸易方式\n    d.busimode,                     -- 经营方式\n    d.psmode,                       -- 销售模式\n    d.loadingport,                  -- 装货港\n    d.loadingportdesc,              -- 装货港描述\n    d.dischargeport,                -- 卸货港\n    d.dischargeportdesc,            -- 卸货港描述\n    d.busitype,                     -- 业务类型\n    d.htype,                        -- 合同类型\n    d.issample,                     -- 是否为样品\n    d.isbacktax,                    -- 是否退税\n    \n    -- 数量指标\n    d.qtc,                          -- 单据数量\n    d.qtcunit,                      -- 单据数量单位\n    d.qty,                          -- 标准库存数量\n    d.qtyunit,                      -- 标准库存单位\n    d.qtx,                          -- 包装数量\n    d.qtxunit,                      -- 包装数量单位\n    d.grossweight,                  -- 毛重\n    d.netweight,                    -- 净重\n    d.volume,                       -- 总体积M3\n    d.stockoutqtc,                  -- 出库单据数量\n    d.stockoutqtx,                  -- 出库包装数量\n    d.stockoutqty,                  -- 出库统计数量\n    d.stockoutqts,                  -- 出库库存数量\n    \n    -- 价格指标\n    d.upric,                        -- 标准数量单价\n    d.fcode,                        -- 原币币种\n    d.sfcode,                       -- 本位币种\n    d.fcy,                          -- 原币金额\n    d.scy,                          -- 折本位币金额\n    d.rcy1,                         -- 折报告币1金额\n    d.rcy2,                         -- 折报告币2金额\n    d.natfcy,                       -- 不含税金额原币金额\n    d.natscy,                       -- 不含税金额原币折本位币金额\n    d.natrcy1,                      -- 不含税金额原币折RMB金额\n    d.natrcy2,                      -- 不含税金额原币折USD金额\n    d.natupric,                     -- 不含税金额单价\n    d.fobfcy,                       -- FOB原币金额\n    d.fobscy,                       -- FOB原币折本位币金额\n    d.fobrcy1,                      -- FOB原币折RMB金额\n    d.fobrcy2,                      -- FOB原币折USD金额\n    d.ciffcy,                       -- CIF原币金额\n    d.cifscy,                       -- CIF原币折本位币金额\n    d.cifrcy1,                      -- CIF原币折RMB金额\n    d.cifrcy2,                      -- CIF原币折USD金额\n    d.advupric,                     -- 建议单价\n    s.pupric,                       -- 定价单价\n    \n    -- 成本利润指标\n    d.purupric,                     -- 采购含税单价\n    d.purfcy,                       -- 采购原币金额\n    d.purscy,                       -- 采购本位币金额\n    d.purrcy1,                      -- 采购人民币金额\n    d.purrcy2,                      -- 采购美元金额\n    d.purnatfcy,                    -- 采购不含税原币金额\n    d.purnatscy,                    -- 采购不含税本位币金额\n    d.purnatrcy1,                   -- 采购不含税人民币金额\n    d.purnatrcy2,                   -- 采购不含税美元金额\n    d.profitrate,                   -- 利润率\n    d.profitfcy,                    -- 原币利润\n    d.profitscy,                    -- 本币利润\n    d.profitrcy1,                   -- 人民币利润\n    d.profitrcy2,                   -- 美元利润\n    d.unitprofitfcy,                -- 单品原币利润\n    d.unitprofitscy,                -- 单品本币利润\n    d.unitprofitrcy1,               -- 单品人民币利润\n    d.unitprofitrcy2,               -- 单品美元利润\n    d.costfcy,                      -- 成本原币金额\n    d.costscy,                      -- 成本本位币金额\n    d.costrcy1,                     -- 成本人民币金额\n    d.costrcy2,                     -- 成本美元金额\n    \n    -- 运输指标\n    d.freightfcode,                 -- 运费币种\n    d.freightfcy,                   -- 运费原币金额\n    d.freightscy,                   -- 运费原币折本位币金额\n    d.freightrcy1,                  -- 运费原币折RMB金额\n    d.freightrcy2,                  -- 运费原币折USD金额\n    d.freupric,                     -- 运费单价\n    d.freightocy,                   -- 运费合同币金额\n    d.insurancefcy,                 -- 保费原币金额\n    d.insurancescy,                 -- 保费原币折本位币金额\n    d.insurancercy1,                -- 保费原币折RMB金额\n    d.insurancercy2,                -- 保费原币折USD金额\n    \n    -- 税费指标\n    d.addtaxrate,                   -- 增值税税率\n    d.addtaxscy,                    -- 增值税原币折本位币金额\n    d.addtaxrcy1,                   -- 增值税原币折RMB金额\n    d.addtaxrcy2,                   -- 增值税原币折USD金额\n    d.customrate,                   -- 关税税率\n    d.customscy,                    -- 关税原币折本位币金额\n    d.customrcy1,                   -- 关税原币折RMB金额\n    d.customrcy2,                   -- 关税原币折USD金额\n    d.expcustomrate,                -- 出口关税率\n    d.customaddtaxscy,              -- 国际贸易增值税本位币金额\n    d.customaddtaxrcy1,             -- 国际贸易增值税报告币1金额\n    d.customaddtaxrcy2,             -- 国际贸易增值税报告币2币金额\n    d.customaddtaxrate,             -- 国际贸易增值税率\n    \n    -- 佣金指标\n    d.cmsfcy,                       -- 佣金原币金额\n    d.cmsscy,                       -- 佣金本币金额\n    d.cmsrcy1,                      -- 佣金折报告币1金额\n    d.cmsrcy2,                      -- 佣金折报告币2金额\n    d.cmsrate,                      -- 佣金率合计\n    d.cmsmethod                     -- 佣金计算方法\nFROM\n    dwi_sal_salshiporderg_n9 d\nLEFT JOIN\n    dwi_sal_salorderg_n9 s\nON\n    d.salordgicodex = s.salordgicodex\n    AND d.salordicodex = s.salordicodex\n    AND d.salordcodex = s.salordcodex\nWHERE\n    d.salordgicodex IS NOT NULL;\n",
	"currentDatabase":"dwi_sal",
	"description":"",
	"directory":"/廉政专项/南北系统/宽表",
	"name":"etl_dwi_sal_lz_steel_export_sales_analysis",
	"templateVersion":"1.0",
	"type":"SparkSQL"
}