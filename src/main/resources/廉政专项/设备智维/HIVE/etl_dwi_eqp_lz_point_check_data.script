{
	"configuration":{},
	"connectionName":"MRS_Spark_Agent",
	"content":"-- SPARK sql \n-- ******************************************************************** --\n-- author: jh_zhaochenlong\n-- create time: 2025/05/26 12:40:50 GMT+08:00\n-- descr: 廉政八项-设备智维专线-点检信息宽表\n-- ******************************************************************** --\n-- DROP TABLE IF EXISTS dwi_eqp.dwi_eqp_lz_point_check_data;\n-- CREATE TABLE\n-- \tdwi_eqp.dwi_eqp_lz_point_check_data (\n--      zone_name STRING COMMENT '任务区域',\n-- \t\thost_eq_name STRING COMMENT '任务主设备',\n-- \t\tbranch_eq_name STRING COMMENT '任务分部设备',\n-- \t\tplan_beg_time STRING COMMENT '任务计划开始时间',\n-- \t\tplan_end_time STRING COMMENT '任务计划结束时间',\n-- \t\tis_chk STRING COMMENT '任务是否完成',\n-- \t\tchk_time STRING COMMENT '任务实际检测时间',\n-- \t\tchk_user_name STRING COMMENT '任务检测人',\n-- \t\tchk_value STRING COMMENT '任务检测值',\n-- \t\tmonitor_vaule STRING COMMENT '设备状态监测值',\n-- \t\tstatus STRING COMMENT '任务状态',\n-- \t\talarm_level STRING COMMENT '任务报警级别',\n-- \t\tchk_source STRING COMMENT '任务点检结果来源',\n-- \t\tpay_card_time STRING COMMENT '任务点检员刷卡时间',\n-- \t\tis_pitfall STRING COMMENT '任务是否转隐患',\n-- \t\tdangerno STRING COMMENT '隐患单号',\n-- \t\tapplytime STRING COMMENT '隐患申报时间',\n-- \t\tapplyuser_name STRING COMMENT '隐患申报人',\n-- \t\tdangerdesc STRING COMMENT '隐患内容',\n-- \t\tstus STRING COMMENT '隐患处理状态',\n-- \t\tdealtype STRING COMMENT '隐患处理方式',\n-- \t\tworkdeptid STRING COMMENT '隐患责任车间',\n-- \t\tsourcetype STRING COMMENT '隐患来源类型',\n-- \t\tdanger_eq STRING COMMENT '隐患设备',\n-- \t\teqpartsname STRING COMMENT '隐患部件',\n-- \t\teqsparename STRING COMMENT '隐患零件',\n-- \t\tcheckpart STRING COMMENT '隐患点检部位',\n-- \t\texctype STRING COMMENT '隐患报警类型',\n-- \t\texcclass STRING COMMENT '隐患报警等级',\n-- \t\texcchecker STRING COMMENT '隐患检查人员',\n-- \t\texctime STRING COMMENT '隐患报警时间',\n-- \t\tcheckstandard STRING COMMENT '隐患判断标准',\n-- \t\tcheckresult STRING COMMENT '隐患点检结果',\n-- \t\tupperlimit  DECIMAL(22,0) COMMENT '隐患报警上限值',\n-- \t\tlowerlimit  DECIMAL(22,0) COMMENT '隐患报警下限值',\n-- \t\tstadvalue   DECIMAL(22,0) COMMENT '隐患报警标准值',\n-- \t\tactualvalue DECIMAL(22,0) COMMENT '隐患实际值',\n-- \t\tmeasureunit STRING COMMENT '隐患单位',\n-- \t\tdealusername STRING COMMENT '隐患处理人员',\n-- \t\tdealtime STRING COMMENT '隐患处理时间',\n-- \t\thandleidea STRING COMMENT '隐患处理意见',\n-- \t\troute_no STRING COMMENT '路线编号',\n-- \t\troute_name STRING COMMENT '路线名称',\n-- \t\tfactory_name STRING COMMENT '路线所属厂',\n-- \t\troute_workshop_name STRING COMMENT '路线所属车间',\n-- \t\tcheck_role_name STRING COMMENT '路线点检角色',\n-- \t\troute_stus STRING COMMENT '路线状态',\n-- \t\tstop_beg_time STRING COMMENT '路线禁用开始时间',\n-- \t\tstop_end_time STRING COMMENT '路线禁用结束时间',\n-- \t\tstop_reason STRING COMMENT '路线禁用原因',\n-- \t\tlast_plan_date STRING COMMENT '路线上次排程时间',\n-- \t\tresp_post_no STRING COMMENT '路线责任岗位',\n-- \t\tresp_emp_name STRING COMMENT '路线责任人',\n-- \t\tis_order STRING COMMENT '路线是否强制顺序',\n-- \t\tchk_is_holiday STRING COMMENT '路线节假日是否点检',\n-- \t\tis_card STRING COMMENT '路线是否采用点检卡',\n-- \t\troute_type STRING COMMENT '点检路线类型',\n-- \t\tzone_no STRING COMMENT '区域编号',\n-- \t\tmf_zone_name STRING COMMENT '区域名称',\n-- \t\tzone_workshop_name STRING COMMENT '区域所属单位',\n-- \t\tcard_no STRING COMMENT '点检卡号',\n-- \t\tcard_status STRING COMMENT '点检卡状态',\n-- \t\tcard_workshop_name STRING COMMENT '点检卡所属单位',\n-- \t\tcyc_name STRING COMMENT '周期名称',\n-- \t\tcyc_qty STRING COMMENT '周期间隔数',\n-- \t\tcyc_unit STRING COMMENT '周期单位',\n-- \t\tstd_beg_date STRING COMMENT '初始排程时间',\n-- \t\tis_delay STRING COMMENT '是否可以延迟执行',\n-- \t\tchk_qty STRING COMMENT '周期次数',\n-- \t\tbeg_time STRING COMMENT '当天点检开始时间',\n-- \t\tend_time STRING COMMENT '当天点检结束时间',\n-- \t\tmonth_of_year STRING COMMENT '一年中第几个月',\n-- \t\tday_of_month STRING COMMENT '一月中第几天',\n-- \t\tweek_of_month STRING COMMENT '一月中第几周',\n-- \t\tday_of_week STRING COMMENT '一周中第几天',\n-- \t\tmf_zone_id STRING COMMENT '区域ID',\n-- \t\tmf_zone_no STRING COMMENT '点检区域编号',\n-- \t\thost_eq_id STRING COMMENT '任务主设备ID',\n-- \t\thost_eq_no STRING COMMENT '任务主设备编码',\n-- \t\tmf_task_id STRING COMMENT '点检任务ID',\n-- \t\troute_id STRING COMMENT '点检路线ID',\n-- \t\tzone_id STRING COMMENT '点检区域ID',\n-- \t\tstd_id STRING COMMENT '点检基准ID',\n-- \t\tmf_danger_id STRING COMMENT '点检异常单ID',\n-- \t\tmf_card_id STRING COMMENT '点检卡ID',\n-- \t\tmf_cycle_id STRING COMMENT '点检周期ID',\n-- \t\tmf_cycle_detail_id STRING COMMENT '点检周期明细ID',\n-- \t\tbranch_eq_id STRING COMMENT '任务分部设备ID',\n-- \t\tbranch_eq_no STRING COMMENT '任务分部设备编码',\n-- \t\teqpartsid STRING COMMENT '隐患部件ID',\n-- \t\teqpartsno STRING COMMENT '隐患部件编码',\n-- \t\teqspareid STRING COMMENT '隐患零件ID',\n-- \t\teqspareno STRING COMMENT '隐患零级编码',\n-- \t\tmeasureunit_id STRING COMMENT '隐患单位ID',\n-- \t\tmeasureunit_no STRING COMMENT '隐患单位编码',\n-- \t\tfactory_id STRING COMMENT '路线所属厂ID',\n-- \t\tfactory_no STRING COMMENT '路线所属厂编码',\n-- \t\troute_workshop_id STRING COMMENT '路线所属车间ID',\n-- \t\troute_workshop_no STRING COMMENT '路线所属车间编码',\n-- \t\tcheck_role_id STRING COMMENT '路线点检角色ID',\n-- \t\tzone_workshop_id STRING COMMENT '区域所属单位ID',\n-- \t\tzone_workshop_no STRING COMMENT '区域所属单位编码',\n-- \t\tcard_workshop_id STRING COMMENT '点检卡所属单位ID',\n-- \t\tcard_workshop_no STRING COMMENT '点检卡所属单位编码'\n-- \t) COMMENT '廉政八项-设备智维专线-点检信息宽表' STORED AS orc TBLPROPERTIES (\"orc.compress\" = \"SNAPPY\");\n\nINSERT \n    OVERWRITE TABLE dwi_eqp.dwi_eqp_lz_point_check_data(\n      zone_name , \n      host_eq_name , \n      branch_eq_name , \n      plan_beg_time , \n      plan_end_time , \n      is_chk , \n      chk_time , \n      chk_user_name , \n      chk_value , \n      monitor_vaule , \n      status , \n      alarm_level , \n      chk_source , \n      pay_card_time , \n      is_pitfall , \n      dangerno , \n      applytime , \n      applyuser_name , \n      dangerdesc , \n      stus , \n      dealtype , \n      workdeptid , \n      sourcetype , \n      danger_eq , \n      eqpartsname , \n      eqsparename , \n      checkpart , \n      exctype , \n      excclass , \n      excchecker , \n      exctime , \n      checkstandard , \n      checkresult , \n      upperlimit , \n      lowerlimit , \n      stadvalue , \n      actualvalue , \n      measureunit , \n      dealusername , \n      dealtime , \n      handleidea , \n      route_no , \n      route_name , \n      factory_name , \n      route_workshop_name , \n      check_role_name , \n      route_stus , \n      stop_beg_time , \n      stop_end_time , \n      stop_reason , \n      last_plan_date , \n      resp_post_no , \n      resp_emp_name , \n      is_order , \n      chk_is_holiday , \n      is_card , \n      route_type , \n      zone_no , \n      mf_zone_name , \n      zone_workshop_name , \n      card_no , \n      card_status , \n      card_workshop_name , \n      cyc_name , \n      cyc_qty , \n      cyc_unit , \n      std_beg_date , \n      is_delay , \n      chk_qty , \n      beg_time , \n      end_time , \n      month_of_year , \n      day_of_month , \n      week_of_month , \n      day_of_week , \n      mf_zone_id , \n      mf_zone_no , \n      host_eq_id , \n      host_eq_no , \n      mf_task_id , \n      route_id , \n      zone_id , \n      std_id , \n      mf_danger_id , \n      mf_card_id, \n      mf_cycle_id , \n      mf_cycle_detail_id , \n      branch_eq_id , \n      branch_eq_no , \n      eqpartsid , \n      eqpartsno , \n      eqspareid , \n      eqspareno , \n      measureunit_id , \n      measureunit_no , \n      factory_id , \n      factory_no , \n      route_workshop_id , \n      route_workshop_no , \n      check_role_id , \n      zone_workshop_id , \n      zone_workshop_no , \n      card_workshop_id , \n      card_workshop_no\n    )\nSELECT\n    mf_zone.zone_name AS zone_name ,              -- 任务区域\n    ma_eq1.eq_name AS host_eq_name ,              -- 任务主设备\n    ma_eq.eq_name AS branch_eq_name ,             -- 任务分部设备\n    mf_task.plan_beg_time AS plan_beg_time ,      -- 任务计划开始时间\n    mf_task.plan_end_time AS plan_end_time ,      -- 任务计划结束时间\n    sys_dictionary_dtl1.str_value AS is_chk ,     -- 任务是否完成\n    mf_task.chk_time AS chk_time ,                -- 任务实际检测时间\n    hr_user1.name AS chk_user_name ,              -- 任务检测人\n    mf_task.chk_value AS chk_value ,              -- 任务检测值\n    mf_task.monitor_vaule AS monitor_vaule ,      -- 设备状态监测值\n    CASE WHEN mf_task.status = 1 THEN '有效'\n         WHEN mf_task.status = 0 THEN '无效'\n         ELSE mf_task.status\n         END AS status ,                          -- 任务状态\n    sys_dictionary_dtl2.str_value AS alarm_level ,-- 任务报警级别\n    sys_dictionary_dtl3.str_value AS chk_source , -- 任务点检结果来源\n    mf_task.pay_card_time AS pay_card_time ,      -- 任务点检员刷卡时间\n    CASE WHEN mf_task.is_pitfall = '0' THEN '否'\n         WHEN mf_task.is_pitfall = '1' THEN '是'\n         ELSE mf_task.is_pitfall\n         END AS is_pitfall ,                      -- 任务是否转隐患\n    mf_danger.dangerno AS dangerno ,              -- 隐患单号\n    mf_danger.applytime AS applytime ,            -- 隐患申报时间\n    hr_user2.name AS applyuser_name ,             -- 隐患申报人\n    mf_danger.dangerdesc AS dangerdesc ,          -- 隐患内容\n    sys_dictionary_dtl4.str_value AS stus ,       -- 隐患处理状态\n    sys_dictionary_dtl5.str_value AS dealtype ,   -- 隐患处理方式\n    CASE WHEN mf_danger.workdeptid = hr_department5.id \n            THEN hr_department5.str_name\n         ELSE mf_danger.workdeptid\n         END AS workdeptid ,                      -- 隐患责任车间\n    sys_dictionary_dtl6.str_value AS sourcetype , -- 隐患来源类型\n    ma_eq.eq_name AS danger_eq ,                  -- 隐患设备\n    ma_eq2.eq_name AS eqpartsname ,               -- 隐患部件\n    ma_eq3.eq_name AS eqsparename ,               -- 隐患零件\n    mf_danger.checkpart AS checkpart ,            -- 隐患点检部位\n    mf_danger.exctype AS exctype ,                -- 隐患报警类型\n    mf_danger.excclass AS excclass ,              -- 隐患报警等级\n    mf_danger.excchecker AS excchecker ,          -- 隐患检查人员\n    mf_danger.exctime AS exctime ,                -- 隐患报警时间\n    mf_danger.checkstandard AS checkstandard ,    -- 隐患判断标准\n    mf_danger.checkresult AS checkresult ,        -- 隐患点检结果\n    mf_danger.upperlimit AS upperlimit ,          -- 隐患报警上限值\n    mf_danger.lowerlimit AS lowerlimit ,          -- 隐患报警下限值\n    mf_danger.stadvalue AS stadvalue ,            -- 隐患报警标准值\n    mf_danger.actualvalue AS actualvalue ,        -- 隐患实际值\n    mf_danger.measureunit AS measureunit ,        -- 隐患单位\n    hr_user3.name AS dealusername ,               -- 隐患处理人员\n    mf_danger.dealtime AS dealtime ,              -- 隐患处理时间\n    mf_danger.handleidea AS handleidea ,          -- 隐患处理意见\n    mf_route.route_no AS route_no ,               -- 路线编号\n    mf_route.route_name AS route_name ,           -- 路线名称\n    hr_department1.str_name AS factory_name ,     -- 路线所属厂\n    hr_department2.str_name AS route_workshop_name , -- 路线所属车间\n    mf_route.check_role_id AS check_role_name ,   -- 路线点检角色\n    sys_dictionary_dtl7.str_value AS route_stus , -- 路线状态\n    mf_route.stop_beg_time AS stop_beg_time ,     -- 路线禁用开始时间\n    mf_route.stop_end_time AS stop_end_time ,     -- 路线禁用结束时间\n    mf_route.stop_reason AS stop_reason ,         -- 路线禁用原因\n    mf_route.last_plan_date AS last_plan_date ,   -- 路线上次排程时间\n    mf_route.resp_post_no AS resp_post_no ,       -- 路线责任岗位\n    mf_route.resp_emp_no AS resp_emp_name ,       -- 路线责任人\n    mf_route.is_order AS is_order ,               -- 路线是否强制顺序\n    CASE WHEN mf_route.chk_is_holiday = '0' THEN '否'\n         WHEN mf_route.chk_is_holiday = '1' THEN '是'\n         ELSE mf_route.chk_is_holiday\n         END AS chk_is_holiday ,                  -- 路线节假日是否点检\n    CASE WHEN mf_route.is_card = '0' THEN '启用点检卡'\n         WHEN mf_route.is_card = '1' THEN '禁用点检卡'\n         ELSE mf_route.is_card\n         END AS is_card ,                         -- 路线是否采用点检卡\n    sys_dictionary_dtl8.str_value AS route_type , -- 点检路线类型\n    mf_zone.zone_no AS zone_no ,                  -- 点检区域编号\n    mf_zone.zone_name AS mf_zone_name ,           -- 区域名称\n    hr_department3.str_name AS zone_workshop_name ,  -- 区域所属单位\n    mf_card.card_no AS card_no ,                     -- 点检卡号\n    sys_dictionary_dtl9.str_value AS card_status ,   -- 点检卡状态\n    hr_department4.str_name AS card_workshop_name ,  -- 点检卡所属单位\n    mf_cycle.cyc_name AS cyc_name ,                  -- 周期名称\n    mf_cycle.cyc_qty AS cyc_qty ,                    -- 周期间隔数\n    sys_dictionary_dtl10.str_value AS cyc_unit ,     -- 周期单位\n    mf_cycle.std_beg_date AS std_beg_date ,          -- 初始排程时间\n    CASE WHEN mf_cycle.is_delay = '0' THEN '否'\n         WHEN mf_cycle.is_delay = '1' THEN '是'\n         ELSE mf_cycle.is_delay\n         END AS is_delay ,                           -- 是否可以延迟执行\n    mf_cycle.chk_qty AS chk_qty ,                    -- 周期次数\n    mf_cycle_detail.beg_time AS beg_time ,           -- 当天点检开始时间\n    mf_cycle_detail.end_time AS end_time ,           -- 当天点检结束时间\n    mf_cycle_detail.month_of_year AS month_of_year , -- 一年中第几个月\n    mf_cycle_detail.day_of_month AS day_of_month ,   -- 一月中第几天\n    mf_cycle_detail.week_of_month AS week_of_month , -- 一月中第几周\n    mf_cycle_detail.day_of_week AS day_of_week ,     -- 一周中第几天\n    mf_zone.id AS mf_zone_id ,                       -- 区域ID\n    mf_zone.zone_no AS mf_zone_no ,                  -- 区域编号\n    ma_eq1.id AS host_eq_id ,                        -- 任务主设备ID\n    ma_eq1.eq_no AS host_eq_no ,                     -- 任务主设备编码\n    mf_task.id AS mf_task_id ,                       -- 点检任务ID\n    mf_task.route_id AS route_id ,                   -- 点检路线ID\n    mf_task.zone_id AS zone_id ,                     -- 点检区域ID\n    mf_task.std_id AS std_id ,                       -- 点检基准ID\n    mf_danger.id AS mf_danger_id ,                   -- 点检异常单ID\n    mf_card.id AS mf_card_id ,                       -- 点检卡ID\n    mf_cycle.id AS mf_cycle_id ,                     -- 点检周期ID\n    mf_cycle_detail.id AS mf_cycle_detail_id ,       -- 点检周期明细ID\n    ma_eq.id AS branch_eq_id ,                       -- 任务分部设备ID\n    ma_eq.eq_no AS branch_eq_no ,                    -- 任务分部设备编码\n    mf_danger.eqpartsid AS eqpartsid ,               -- 隐患部件ID\n    ma_eq2.eq_no AS eqpartsno ,                      -- 隐患部件编码\n    mf_danger.eqspareid AS eqspareid ,               -- 隐患零件ID\n    ma_eq3.eq_no AS eqspareno ,                      -- 隐患零件编码\n    mf_danger.measureunit AS measureunit_id  ,       -- 隐患单位ID\n    mf_danger.measureunit AS measureunit_no  ,       -- 隐患单位编码\n    mf_route.factory_id AS factory_id ,              -- 路线所属厂ID\n    hr_department1.str_sn AS factory_no ,            -- 路线所属厂编码\n    mf_route.workshop_id AS route_workshop_id ,      -- 路线所属车间ID\n    hr_department2.str_sn AS route_workshop_no ,     -- 路线所属车间编码\n    mf_route.check_role_id AS check_role_id  ,       -- 路线点检角色ID\n    mf_zone.workshop_id AS zone_workshop_id ,        -- 区域所属单位ID\n    hr_department3.str_sn AS zone_workshop_no ,      -- 区域所属单位编码\n    mf_card.workshop_id AS card_workshop_id ,        -- 点检卡所属单位ID\n    hr_department4.str_sn AS card_workshop_no        -- 点检卡所属单位编码\n\nFROM  \n    (SELECT * FROM dwi_eqp.dwi_eqp_mf_task WHERE status = 1) mf_task\nJOIN  \n    (SELECT * FROM dwi_eqp.dwi_eqp_mf_standard WHERE status = 1) mf_standard\n    ON mf_task.std_id = mf_standard.id\nLEFT JOIN \n    (SELECT * FROM dwi_eqp.dwi_eqp_mf_danger WHERE status = 1) mf_danger\n    ON mf_task.id = mf_danger.chktaskid\nJOIN \n    (SELECT * FROM dwi_eqp.dwi_eqp_mf_route WHERE status = 1) mf_route\n    ON mf_task.route_id = mf_route.id\nLEFT JOIN \n    (SELECT * FROM dwi_eqp.dwi_eqp_mf_zone WHERE status = 1) mf_zone\n    ON mf_task.zone_id = mf_zone.id\nLEFT JOIN \n    (SELECT * FROM dwi_eqp.dwi_eqp_mf_card WHERE status = 1) mf_card\n    ON mf_zone.card_id = mf_card.id\nLEFT JOIN \n    (SELECT * FROM dwi_eqp.dwi_eqp_mf_cycle WHERE status = 1) mf_cycle\n    ON mf_cycle.stander_id = mf_standard.id\nLEFT JOIN \n    (SELECT * FROM dwi_eqp.dwi_eqp_mf_cycle_detail WHERE status = 1) mf_cycle_detail\n    ON mf_cycle.id = mf_cycle_detail.cyc_id\nLEFT JOIN \n    (SELECT id,eq_name,eq_no,parent_id FROM dwi_eqp.dwi_eqp_ma_eq WHERE status = 1) ma_eq\n    ON mf_task.eq_id = ma_eq.id\nLEFT JOIN \n    (SELECT id,eq_name,eq_no FROM dwi_eqp.dwi_eqp_ma_eq WHERE status = 1) ma_eq1\n    ON ma_eq.parent_id = ma_eq1.id\nLEFT JOIN \n    (SELECT str_key,str_value FROM dwi_eqp.dwi_eqp_sys_dictionary_dtl WHERE dict_sn = 'mfIsChk') sys_dictionary_dtl1\n    ON mf_task.is_chk = sys_dictionary_dtl1.str_key\nLEFT JOIN \n    dwi_eqp.dwi_eqp_hr_user hr_user1\n    ON mf_task.chk_user_id = hr_user1.id\nLEFT JOIN \n    (SELECT str_key,str_value FROM dwi_eqp.dwi_eqp_sys_dictionary_dtl WHERE dict_sn = 'mfAlarmLevel') sys_dictionary_dtl2\n    ON mf_task.alarm_level = sys_dictionary_dtl2.str_key\nLEFT JOIN \n    (SELECT str_key,str_value FROM dwi_eqp.dwi_eqp_sys_dictionary_dtl WHERE dict_sn = 'mfChkSource') sys_dictionary_dtl3\n    ON mf_task.chk_source = sys_dictionary_dtl3.str_key\nLEFT JOIN \n    dwi_eqp.dwi_eqp_hr_user hr_user2\n    ON mf_danger.applyuserid = hr_user2.id\nLEFT JOIN \n    (SELECT str_key,str_value FROM dwi_eqp.dwi_eqp_sys_dictionary_dtl WHERE dict_sn = 'MfDanStus') sys_dictionary_dtl4\n    ON mf_danger.stus = sys_dictionary_dtl4.str_key\nLEFT JOIN \n    (SELECT str_key,str_value FROM dwi_eqp.dwi_eqp_sys_dictionary_dtl WHERE dict_sn = 'MfDanDealType') sys_dictionary_dtl5\n    ON mf_danger.dealtype = sys_dictionary_dtl5.str_key\nLEFT JOIN \n    (SELECT str_key,str_value FROM dwi_eqp.dwi_eqp_sys_dictionary_dtl WHERE dict_sn = 'recondition_sourceType') sys_dictionary_dtl6\n    ON mf_danger.sourcetype = sys_dictionary_dtl6.str_key\nLEFT JOIN \n    (SELECT id,eq_name,eq_no FROM dwi_eqp.dwi_eqp_ma_eq WHERE status = 1) ma_eq2\n    ON mf_danger.eqpartsid = ma_eq2.id\nLEFT JOIN \n    (SELECT id,eq_name,eq_no FROM dwi_eqp.dwi_eqp_ma_eq WHERE status = 1) ma_eq3\n    ON mf_danger.eqspareid = ma_eq3.id\nLEFT JOIN \n    dwi_eqp.dwi_eqp_hr_user hr_user3\n    ON mf_danger.dealuserid = hr_user3.id\nLEFT JOIN \n    dwi_eqp.dwi_eqp_hr_department hr_department1\n    ON mf_route.factory_id = hr_department1.id\nLEFT JOIN \n    dwi_eqp.dwi_eqp_hr_department hr_department2\n    ON mf_route.workshop_id = hr_department2.id\nLEFT JOIN \n    (SELECT str_key,str_value FROM dwi_eqp.dwi_eqp_sys_dictionary_dtl WHERE dict_sn = 'mfChkRoutStus') sys_dictionary_dtl7\n    ON mf_route.route_stus = sys_dictionary_dtl7.str_key\nLEFT JOIN \n    (SELECT str_key,str_value FROM dwi_eqp.dwi_eqp_sys_dictionary_dtl WHERE dict_sn = 'mfRouteType') sys_dictionary_dtl8\n    ON mf_route.route_type = sys_dictionary_dtl8.str_key\nLEFT JOIN \n    dwi_eqp.dwi_eqp_hr_department hr_department3\n    ON mf_zone.workshop_id = hr_department3.id\nLEFT JOIN \n    (SELECT str_key,str_value FROM dwi_eqp.dwi_eqp_sys_dictionary_dtl WHERE dict_sn = 'mfCardStus') sys_dictionary_dtl9\n    ON mf_card.card_status = sys_dictionary_dtl9.str_key\nLEFT JOIN \n    dwi_eqp.dwi_eqp_hr_department hr_department4\n    ON mf_card.workshop_id = hr_department4.id\nLEFT JOIN \n    (SELECT str_key,str_value FROM dwi_eqp.dwi_eqp_sys_dictionary_dtl WHERE dict_sn = 'mfCycUnit') sys_dictionary_dtl10\n    ON mf_cycle.cyc_unit = sys_dictionary_dtl10.str_key\nLEFT JOIN \n    dwi_eqp.dwi_eqp_hr_department hr_department5\n    ON mf_danger.workdeptid = hr_department5.id\n;",
	"currentDatabase":"dwi_prd",
	"description":"",
	"directory":"/廉政专项/设备智维/HIVE",
	"name":"etl_dwi_eqp_lz_point_check_data",
	"owner":"jh_zhaochenlong",
	"templateVersion":"1.0",
	"type":"SparkSQL"
}