{
	"configuration":{},
	"connectionName":"MRS_Spark_Agent",
	"content":"-- ******************************************************************** --\n-- author: jh_caiyi\n-- create time: 2025-07-15\n-- descr:智慧运营中心部分数据概览-智慧营销系统专线明细_tbsonj012\n-- sms_orderdelivery_tbsonj012\n-- ******************************************************************** --\n-- DROP TABLE IF EXISTS dwi_log.dwi_log_lz_sms_orderdelivery_tbsonj012;\n-- CREATE TABLE dwi_log.dwi_log_lz_sms_orderdelivery_tbsonj012 (\n--     compid varchar(10) COMMENT '公司别',\n--     orderno varchar(15) COMMENT '订单编号',\n--     orderver varchar(2) COMMENT '订单变更版次',\n--     orderitem varchar(3) COMMENT '订单项次',\n--     psrno varchar(80) COMMENT '产品规范编号',\n--     apnno varchar(5) COMMENT '用途码',\n--     proddetailclass varchar(5) COMMENT '产品细分类',\n--     mscno varchar(20) COMMENT '制造标准代码',\n--     standname varchar(200) COMMENT '标准全名',\n--     prodspecno varchar(60) COMMENT '牌号',\n--     shippingdate varchar(8) COMMENT '交期',\n--     orderthick DECIMAL(32,6) COMMENT '厚度',\n--     orderthickedit varchar(10) COMMENT '厚度',\n--     orderthickunit varchar(5) COMMENT '厚度单位',\n--     fixflag varchar(1) COMMENT '是否为全定呎',\n--     singlelength DECIMAL(32,6) COMMENT '单倍呎长度',\n--     singlelengthedit varchar(6) COMMENT '单倍呎长度',\n--     singlelengthunit varchar(5) COMMENT '单倍呎单位',\n--     orderwidth DECIMAL(32,6) COMMENT '宽度',\n--     orderwidthedit varchar(8) COMMENT '宽度',\n--     orderwidthunit varchar(5) COMMENT '宽度单位',\n--     orderlength DECIMAL(32,6) COMMENT '长度',\n--     orderlengthedit varchar(9) COMMENT '长度',\n--     orderlengthunit varchar(5) COMMENT '长度单位',\n--     orderweight DECIMAL(32,6) COMMENT '订单重量',\n--     orderqty varchar(9) COMMENT '订单数量',\n--     orderqtyunit varchar(5) COMMENT '计价单位',\n--     orderprice DECIMAL(32,6) COMMENT '订单单价',\n--     lockorderprice varchar(1) COMMENT '锁定价',\n--     freightprice DECIMAL(32,6) COMMENT '运费单价',\n--     otherprice1 DECIMAL(32,6) COMMENT '其它加价1',\n--     addpricereason1 varchar(5) COMMENT '加价原因1',\n--     otherprice2 DECIMAL(32,6) COMMENT '其它加价2',\n--     addpricereason2 varchar(5) COMMENT '加价原因2',\n--     otherprice3 DECIMAL(32,6) COMMENT '其它加价3',\n--     addpricereason3 varchar(5) COMMENT '加价原因3',\n--     chgprice DECIMAL(32,6) COMMENT '变更加价',\n--     specialpriceflag varchar(1) COMMENT '是否为特准文号',\n--     specialcode varchar(10) COMMENT '特准文号',\n--     unitprice DECIMAL(32,6) COMMENT '总单价',\n--     simucost1 DECIMAL(32,6) COMMENT '预估成本(工序还原)',\n--     simucost2 DECIMAL(32,6) COMMENT '预估成本(大还原)',\n--     specmark varchar(60) COMMENT '规格描述',\n--     metricsizemark varchar(60) COMMENT '公制档尺寸描述',\n--     englishsizemark varchar(60) COMMENT '英制档尺寸描述',\n--     recorderno varchar(5) COMMENT '收货人序号',\n--     dispweight DECIMAL(32,6) COMMENT '已开发货通知单重量',\n--     dispqty DECIMAL(32,6) COMMENT '已开发货通知单数量',\n--     deliweight DECIMAL(32,6) COMMENT '已出货重量',\n--     deliqty DECIMAL(32,6) COMMENT '已出货数量',\n--     lastshipdate varchar(8) COMMENT '最后出货日',\n--     sizemsg varchar(1) COMMENT '尺寸信息',\n--     qualityclass varchar(2) COMMENT '质量分类',\n--     shipexactly varchar(1) COMMENT '溢短装',\n--     shiptolmax DECIMAL(32,6) COMMENT '交货公差上限',\n--     shiptolmin DECIMAL(32,6) COMMENT '交货公差下限',\n--     lmaxlength DECIMAL(32,6) COMMENT '长尺上限',\n--     lminlength DECIMAL(32,6) COMMENT '长尺下限',\n--     smaxlength DECIMAL(32,6) COMMENT '短尺上限',\n--     sminlenght DECIMAL(32,6) COMMENT '短尺下限',\n--     nitemratio DECIMAL(32,6) COMMENT '非定尺率',\n--     status varchar(2) COMMENT '订单项次状态',\n--     lineupstatus varchar(2) COMMENT '订单项次Lineup状态',\n--     creempno varchar(8) COMMENT '新增人员',\n--     credate varchar(8) COMMENT '新增日期',\n--     uptempno varchar(8) COMMENT '修改人员',\n--     uptdate varchar(8) COMMENT '修改日期',\n--     cfmempno varchar(8) COMMENT '确认人员',\n--     cfmdate varchar(8) COMMENT '确认日期',\n--     uncfmempno varchar(8) COMMENT '取消确认人员',\n--     uncfmdate varchar(8) COMMENT '取消确认日期',\n--     clsreason varchar(5) COMMENT '结案原因',\n--     clsempno varchar(8) COMMENT '结案人员',\n--     clsdate varchar(8) COMMENT '结案日期',\n--     endcustno varchar(30) COMMENT '最终用户',\n--     cfmtime varchar(8) COMMENT '确认时间',\n--     lotno varchar(20) COMMENT '批号',\n--     specialcase varchar(5) COMMENT '特殊调整',\n--     itemtotalamt DECIMAL(32,6) COMMENT '项次总金额',\n--     closestus varchar(2) COMMENT '结案状态',\n--     orginitem varchar(4) COMMENT '原项次号',\n--     isdelisimilar varchar(1) COMMENT '可出齐尺',\n--     pricever varchar(10) COMMENT '价格版次',\n--     njorderno varchar(15) COMMENT '南钢订单编号',\n--     njorderitem varchar(3) COMMENT '南钢订单项次',\n--     mescon varchar(5) COMMENT 'MES反馈信息',\n--     isthirdapprove varchar(1) COMMENT '是否第三方认证',\n--     specialdiff DECIMAL(32,6) COMMENT '特准差价',\n--     shipname varchar(40) COMMENT '船级社',\n--     baseprice DECIMAL(32,6) COMMENT '订单基价',\n--     qtyaddprice varchar(1) COMMENT '块数加价',\n--     newprodno varchar(15) COMMENT '合同评审单号',\n--     prodspecnosub varchar(60) COMMENT '原牌号',\n--     lineupexecute varchar(2) COMMENT '是否正在执行lineup',\n--     force varchar(15) COMMENT '是否强制放行',\n--     orderlengtha DECIMAL(32,6) COMMENT '长度一',\n--     orderlengthaedit varchar(6) COMMENT '长度一',\n--     orderlengthaunit varchar(5) COMMENT '长度一单位',\n--     orderlengthb DECIMAL(32,6) COMMENT '长度二',\n--     orderlengthbedit varchar(6) COMMENT '长度二',\n--     orderlengthbunit varchar(5) COMMENT '长度二单位',\n--     orderlengthc DECIMAL(32,6) COMMENT '长度三',\n--     orderlengthcedit varchar(6) COMMENT '长度三',\n--     orderlengthcunit varchar(5) COMMENT '长度三单位',\n--     orderlengthd DECIMAL(32,6) COMMENT '长度四',\n--     orderlengthdedit varchar(6) COMMENT '长度四',\n--     orderlengthdunit varchar(5) COMMENT '长度四单位',\n--     orderlengthe DECIMAL(32,6) COMMENT '长度五',\n--     orderlengtheedit varchar(6) COMMENT '长度五',\n--     orderlengtheunit varchar(5) COMMENT '长度五单位',\n--     orderthicka DECIMAL(32,6) COMMENT '厚度一',\n--     orderthickaedit varchar(10) COMMENT '厚度一',\n--     orderthickaunit varchar(5) COMMENT '厚度一单位',\n--     orderthickb DECIMAL(32,6) COMMENT '厚度二',\n--     orderthickbedit varchar(10) COMMENT '厚度二',\n--     orderthickbunit varchar(5) COMMENT '厚度二单位',\n--     orderthickc DECIMAL(32,6) COMMENT '厚度三',\n--     orderthickcedit varchar(10) COMMENT '厚度三',\n--     orderthickcunit varchar(5) COMMENT '厚度三单位',\n--     iscontact varchar(25) COMMENT '合同评审是否通过',\n--     contractnotz varchar(15) COMMENT '特准合同编号',\n--     itemno varchar(3) COMMENT '合同评审项次',\n--     addpricereasonone varchar(5) COMMENT '加价原因1',\n--     addpricereasontwo varchar(5) COMMENT '加价原因2',\n--     addpricereasonthree varchar(5) COMMENT '加价原因3',\n--     otherpricetwo DECIMAL(32,6) COMMENT '其它加价2',\n--     otherpriceone DECIMAL(32,6) COMMENT '其它加价1',\n--     uncfmonce varchar(2) COMMENT '订单取消确认第一次',\n--     jitstringa varchar(50) COMMENT '船号',\n--     jitstringb varchar(50) COMMENT '批次号',\n--     jitstringc varchar(50) COMMENT '分段号',\n--     jitid DECIMAL(32,6) COMMENT '交付编号',\n--     defactory varchar(5) COMMENT '生产厂',\n--     isbatch varchar(1) COMMENT '是否批量汇入订单',\n--     isagree varchar(1) COMMENT '是否核准',\n--     isvipcust varchar(1) COMMENT '是否重点订单',\n--     custappfactory varchar(5) COMMENT '客户指定生产厂',\n--     lineupfactory varchar(5) COMMENT 'lineup返回生产厂',\n--     isqualityobj varchar(1) COMMENT '是否质量异议订单',\n--     shipmemo varchar(50) COMMENT '交货期备注',\n--     custappreason varchar(1) COMMENT '指定产线原因',\n--     custappmemo varchar(100) COMMENT '指定产线原因说明',\n--     isoverprodagree varchar(1) COMMENT '是否超出生产许可',\n--     hotthick DECIMAL(32,6) COMMENT '银亮棒热轧厚度',\n--     compareresult varchar(500) COMMENT '订单匹配结果',\n--     isconfirm varchar(1) COMMENT '是否确认过',\n--     isbloomorder varchar(8) COMMENT 'E2E最终客户',\n--     comparerescope varchar(500) COMMENT '订单匹配结果(复制)',\n--     searchitemno varchar(4) COMMENT '询单项次',\n--     poacost DECIMAL(32,6) COMMENT '成本',\n--     poacostadd DECIMAL(32,6) COMMENT '成本(附加成本)',\n--     poacostcontract DECIMAL(32,6) COMMENT '成本(合同评审)',\n--     profitprice DECIMAL(32,6) COMMENT '毛利',\n--     guideprice DECIMAL(32,6) COMMENT '指导价',\n--     thkisdecimal DECIMAL(32,6) COMMENT '直径是否小数',\n--     isyjd varchar(1) COMMENT '是否预接单订单',\n--     ispass varchar(1) COMMENT '预接单放行',\n--     qsitem varchar(50) COMMENT '电商草约项次',\n--     guid varchar(32) COMMENT '新试逻辑主键',\n--     newclassstatus varchar(1) COMMENT '新试状态',\n--     testcheckdate varchar(14) COMMENT '新试检查日期',\n--     testsend varchar(1) COMMENT '新试抛送状态',\n--     testsenddate varchar(14) COMMENT '新试抛送日期',\n--     stdsteelcode varchar(15) COMMENT '炼钢代码',\n--     orderthickjc DECIMAL(32,6) COMMENT '基材厚度',\n--     orderthickfc DECIMAL(32,6) COMMENT '覆材厚度',\n--     largecate varchar(3) COMMENT '大类',\n--     middlecate varchar(3) COMMENT '中类',\n--     subcate varchar(3) COMMENT '小类',\n--     steelspray varchar(3) COMMENT '钢板喷涂',\n--     steelpack varchar(3) COMMENT '钢板打包',\n--     steelshotblast varchar(3) COMMENT '钢板抛丸',\n--     steelsloteprocess varchar(3) COMMENT '钢板坡口加工',\n--     searchrevision varchar(14) COMMENT '询单编号',\n--     innercodegm varchar(20) COMMENT '国贸合同内码',\n--     steeloutprocess varchar(3) COMMENT '其他外加工',\n--     codenumber varchar(15) COMMENT '商品序号',\n--     sailingdate varchar(8) COMMENT '船期',\n--     marineboard varchar(4) COMMENT '海工板',\n--     orderpriceory DECIMAL(32,6) COMMENT '订单单价(特钢营销计算效益用)',\n--     priceverory varchar(10) COMMENT '价格版次(特钢营销用)',\n--     iscrlplan varchar(1) COMMENT '是否走控制计划',\n--     isquaprice varchar(1) COMMENT '是否季度定价',\n--     salesmodel varchar(1) COMMENT '销售模式',\n--     custapn varchar(1) COMMENT '客户用途',\n--     inputprice DECIMAL(32,6) COMMENT '询单单价(板材手动录入)',\n--     rullboardcut varchar(1) COMMENT '小尺板分切',\n--     paintupt varchar(1) COMMENT '更改标识',\n--     adjustprice DECIMAL(32,6) COMMENT '调整金额',\n--     orderpriceb DECIMAL(32,6) COMMENT '阿米巴订单单价B',\n--     custshipdate varchar(8) COMMENT '客户交期',\n--     ordersort varchar(1) COMMENT '订单分类',\n--     finalcust varchar(30) COMMENT '终端客户',\n--     gmsid varchar(30) COMMENT 'GMS序号',\n--     agreeempno varchar(8) COMMENT '核准人员',\n--     custend varchar(8) COMMENT '回抛子公司规范时间',\n--     fobprice DECIMAL(32,6) COMMENT 'FOB价格',\n--     contype varchar(1) COMMENT '合同类型',\n--     gradecode varchar(20) COMMENT '坯料钢种',\n--     specialsteelunit varchar(20) COMMENT '特用钢采购单位',\n--     memo varchar(300) COMMENT '询单品种',\n--     finalcustname varchar(100) COMMENT '终端客户名称',\n--     projid varchar(20) COMMENT '工程号',\n--     sectionno varchar(20) COMMENT '分段号',\n--     etl_date DATE COMMENT 'ETL时间'\n-- )\n-- COMMENT '廉政八项-智慧运营中心-智慧营销系统专线明细_tbsonj012'\n-- STORED AS ORC;\n\nINSERT OVERWRITE TABLE dwi_log.dwi_log_lz_sms_orderdelivery_tbsonj012\nSELECT \n    compid,\n    orderno,\n    orderver,\n    orderitem,\n    psrno,\n    apnno,\n    proddetailclass,\n    mscno,\n    standname,\n    prodspecno,\n    shippingdate,\n    orderthick,\n    orderthickedit,\n    orderthickunit,\n    fixflag,\n    singlelength,\n    singlelengthedit,\n    singlelengthunit,\n    orderwidth,\n    orderwidthedit,\n    orderwidthunit,\n    orderlength,\n    orderlengthedit,\n    orderlengthunit,\n    orderweight,\n    orderqty,\n    orderqtyunit,\n    orderprice,\n    lockorderprice,\n    freightprice,\n    otherprice1,\n    addpricereason1,\n    otherprice2,\n    addpricereason2,\n    otherprice3,\n    addpricereason3,\n    chgprice,\n    specialpriceflag,\n    specialcode,\n    unitprice,\n    simucost1,\n    simucost2,\n    specmark,\n    metricsizemark,\n    englishsizemark,\n    recorderno,\n    dispweight,\n    dispqty,\n    deliweight,\n    deliqty,\n    lastshipdate,\n    sizemsg,\n    qualityclass,\n    shipexactly,\n    shiptolmax,\n    shiptolmin,\n    lmaxlength,\n    lminlength,\n    smaxlength,\n    sminlenght,\n    nitemratio,\n    status,\n    lineupstatus,\n    creempno,\n    credate,\n    uptempno,\n    uptdate,\n    cfmempno,\n    cfmdate,\n    uncfmempno,\n    uncfmdate,\n    clsreason,\n    clsempno,\n    clsdate,\n    endcustno,\n    cfmtime,\n    lotno,\n    specialcase,\n    itemtotalamt,\n    closestus,\n    orginitem,\n    isdelisimilar,\n    pricever,\n    njorderno,\n    njorderitem,\n    mescon,\n    isthirdapprove,\n    specialdiff,\n    shipname,\n    baseprice,\n    qtyaddprice,\n    newprodno,\n    prodspecnosub,\n    lineupexecute,\n    force,\n    orderlengtha,\n    orderlengthaedit,\n    orderlengthaunit,\n    orderlengthb,\n    orderlengthbedit,\n    orderlengthbunit,\n    orderlengthc,\n    orderlengthcedit,\n    orderlengthcunit,\n    orderlengthd,\n    orderlengthdedit,\n    orderlengthdunit,\n    orderlengthe,\n    orderlengtheedit,\n    orderlengtheunit,\n    orderthicka,\n    orderthickaedit,\n    orderthickaunit,\n    orderthickb,\n    orderthickbedit,\n    orderthickbunit,\n    orderthickc,\n    orderthickcedit,\n    orderthickcunit,\n    iscontact,\n    contractnotz,\n    itemno,\n    addpricereasonone,\n    addpricereasontwo,\n    addpricereasonthree,\n    otherpricetwo,\n    otherpriceone,\n    uncfmonce,\n    jitstringa,\n    jitstringb,\n    jitstringc,\n    jitid,\n    defactory,\n    isbatch,\n    isagree,\n    isvipcust,\n    custappfactory,\n    lineupfactory,\n    isqualityobj,\n    shipmemo,\n    custappreason,\n    custappmemo,\n    isoverprodagree,\n    hotthick,\n    compareresult,\n    isconfirm,\n    isbloomorder,\n    comparerescope,\n    searchitemno,\n    poacost,\n    poacostadd,\n    poacostcontract,\n    profitprice,\n    guideprice,\n    thkisdecimal,\n    isyjd,\n    ispass,\n    qsitem,\n    guid,\n    newclassstatus,\n    testcheckdate,\n    testsend,\n    testsenddate,\n    stdsteelcode,\n    orderthickjc,\n    orderthickfc,\n    largecate,\n    middlecate,\n    subcate,\n    steelspray,\n    steelpack,\n    steelshotblast,\n    steelsloteprocess,\n    searchrevision,\n    innercodegm,\n    steeloutprocess,\n    codenumber,\n    sailingdate,\n    marineboard,\n    orderpriceory,\n    priceverory,\n    iscrlplan,\n    isquaprice,\n    salesmodel,\n    custapn,\n    inputprice,\n    rullboardcut,\n    paintupt,\n    adjustprice,\n    orderpriceb,\n    custshipdate,\n    ordersort,\n    finalcust,\n    gmsid,\n    agreeempno,\n    custend,\n    fobprice,\n    contype,\n    gradecode,\n    specialsteelunit,\n    memo,\n    finalcustname,\n    projid,\n    sectionno,\n    CURRENT_DATE() AS etl_date\nFROM \n    dwi_log.dwi_log_tbsonj012;\n",
	"currentDatabase":"dwi_mkt",
	"description":"",
	"directory":"/廉政专项/智慧营销/宽表",
	"name":"etl_dwi_sal_lz_sms_orderdelivery_tbsonj012",
	"templateVersion":"1.0",
	"type":"SparkSQL"
}