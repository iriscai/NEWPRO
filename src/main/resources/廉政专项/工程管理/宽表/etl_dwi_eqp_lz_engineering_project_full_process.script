{
	"configuration":{},
	"connectionName":"MRS_Spark_Agent",
	"content":"-- SPARK sql \n-- ******************************************************************** --\n-- author: jh_caiyi\n-- create time: 2025-07-15\n-- descr: 廉政八项-工程项目-全流程数据展示宽表数据加载\n-- ******************************************************************** --\n-- DROP TABLE IF EXISTS dwi_eqp.dwi_eqp_lz_engineering_project_full_process;\n-- CREATE TABLE\n-- \tdwi_eqp.dwi_eqp_lz_engineering_project_full_process (\n--         particular_year STRING COMMENT '申报年份',\n--         business_unit STRING COMMENT '事业部',\n--         project_type STRING COMMENT '项目类别',\n--         project_plan_name STRING COMMENT '项目计划名称',\n--         apply_fee DECIMAL(20,2) COMMENT '预算费用',\n--         benifit_fee DECIMAL(20,2) COMMENT '效益',\n--         proj_resp_empno STRING COMMENT '项目方案负责人',\n--         next_verify_emp STRING COMMENT '当前审核人',\n--         latest_period_status STRING COMMENT '最新阶段状态',\n--         verify_status STRING COMMENT '审核状态',\n--         apply_emp STRING COMMENT '申报人',\n--         proj_start_date STRING COMMENT '计划开工时间',\n--         proj_end_date STRING COMMENT '计划完工时间',\n--         period_reason_b STRING COMMENT '补充作废理由',\n--         cima2_id STRING COMMENT '系统码',\n        \n--         -- 项目预算信息 (来自tbciaBudget)\n--         build_process_cost DECIMAL(20,2) COMMENT '建筑工程费',\n--         install_cost DECIMAL(20,2) COMMENT '安装工程费',\n--         equipment_cost DECIMAL(20,2) COMMENT '设备费',\n--         other_cost DECIMAL(20,2) COMMENT '其他费',\n--         sub_cost DECIMAL(20,2) COMMENT '合计',\n--         unit STRING COMMENT '单位',\n--         qty STRING COMMENT '数量',\n--         scale STRING COMMENT '重量/t',\n--         target_value STRING COMMENT '指标',\n--         budget_remark STRING COMMENT '预算备注',\n        \n--         -- 项目进度信息 (来自tbcima6)\n--         progress_type STRING COMMENT '进度类型',\n--         plan_start_date STRING COMMENT '计划开始日期',\n--         plan_finish_date STRING COMMENT '计划完成日期',\n--         engineering_content STRING COMMENT '工程内容',\n        \n--         -- 项目预立项信息 (来自tbcima2b)\n--         pre_project_amt DECIMAL(20,2) COMMENT '预立项费用',\n--         ceo_period_status STRING COMMENT '总裁阶段审核状态',\n        \n--         -- 项目论证申请信息 (来自tbkea01)\n--         proj_apply_no STRING COMMENT '论证申请编号',\n--         proj_apply_name STRING COMMENT '论证申请名称',\n--         construct_userno STRING COMMENT '建设单位(人)',\n--         custody_deptno_principal STRING COMMENT '业主单位负责人',\n--         proj_manager STRING COMMENT '项目经理',\n--         project_principal_tel STRING COMMENT '项目经理电话',\n--         division STRING COMMENT '所属事业部',\n--         do_manage_deptno STRING COMMENT '实施主管单位',\n--         pro_manage_deptno STRING COMMENT '专业主管单位',\n--         benefit_deptno STRING COMMENT '受益单位',\n--         period STRING COMMENT '绝对工期',\n--         proj_apply_resp_empno STRING COMMENT '项目方案负责人',\n--         proj_apply_writer STRING COMMENT '项目方案技术研究报告执笔人',\n--         is_projplan STRING COMMENT '是否计划内',\n--         proj_plan_no STRING COMMENT '项目计划号',\n--         proj_type STRING COMMENT '项目类型',\n--         is_benefit STRING COMMENT '是否效益',\n--         is_post STRING COMMENT '是否涉及岗位增减',\n--         posts DECIMAL(10,0) COMMENT '岗位人数',\n--         currnt_situation STRING COMMENT '现状和必要性',\n--         reason STRING COMMENT '项目主要内容',\n--         main_content STRING COMMENT '项目实施和改造的主要内容',\n--         relevant_content STRING COMMENT '创新性、智能/数字化',\n--         it_demand STRING COMMENT '能源的提升与评估',\n--         energy_demand STRING COMMENT '要说明的其它相关事项等',\n--         status STRING COMMENT '状态',\n--         apply_date STRING COMMENT '申报日期',\n--         apply_time STRING COMMENT '申报时间',\n--         issue_emp_no STRING COMMENT '当前操作人',\n--         is_add_to_proof STRING COMMENT '是否增补立项',\n--         aim_cimp1_no STRING COMMENT '增补论证立项号',\n--         creative STRING COMMENT '项目可行性',\n--         is_new_plan STRING COMMENT '是否新概算'\n--     \t) COMMENT '廉政八项-工程项目-全流程数据展示宽表'\n-- PARTITIONED BY (mt STRING COMMENT '分区月份')\n-- STORED AS ORC;\n-- 数据插入语句\n-- 基础数据明细表数据插入\n-- PARTITION(dt='${bdp.system.bizdate}')\nINSERT OVERWRITE TABLE dwi_eqp.dwi_eqp_lz_engineering_project_full_process  PARTITION (mt='202506')\nSELECT\n    -- 项目基本信息 (来自tbcima2)\n    c2.particularYear AS particular_year,\n    c2.businessUnit AS business_unit,\n    c2.projectType AS project_type,\n    c2.projectplanname AS project_plan_name,\n    c2.applyFee AS apply_fee,\n    c2.benifitFee AS benifit_fee,\n    c2.projRespEmpno AS proj_resp_empno,\n    c2.nextVerifyEmp AS next_verify_emp,\n    c2.latestPeriodStatus AS latest_period_status,\n    c2.verifyStatus AS verify_status,\n    c2.applyEmp AS apply_emp,\n    c2.projstartdate AS proj_start_date,\n    c2.projenddate AS proj_end_date,\n    c2.periodReasonB AS period_reason_b,\n    c2.cima2id AS cima2_id,\n    \n    -- 项目预算信息 (来自tbciaBudget)\n    cb.buildProcessCost AS build_process_cost,\n    cb.installCost AS install_cost,\n    cb.equipmentCost AS equipment_cost,\n    cb.otherCost AS other_cost,\n    cb.subCost AS sub_cost,\n    cb.unit AS unit,\n    cb.qty AS qty,\n    cb.scale AS scale,\n    cb.targetValue AS target_value,\n    cb.remark AS budget_remark,\n    \n    -- 项目进度信息 (来自tbcima6)\n    c6.progressType AS progress_type,\n    c6.startDate AS plan_start_date,\n    c6.finishDate AS plan_finish_date,\n    c6.remark AS engineering_content,\n    \n    -- 项目预立项信息 (来自tbcima2b)\n    c2b.preprojectAMT AS pre_project_amt,\n    c2b.latestPeriodStatus AS ceo_period_status,\n    \n    -- 项目论证申请信息 (来自tbkea01)\n    k.projApplyNo AS proj_apply_no,\n    k.projApplyName AS proj_apply_name,\n    k.constructUserno AS construct_userno,\n    k.custodyDeptnoPrincipal AS custody_deptno_principal,\n    k.projManager AS proj_manager,\n    k.projectprincipaltel AS project_principal_tel,\n    k.division AS division,\n    k.doManageDeptno AS do_manage_deptno,\n    k.proManageDeptno AS pro_manage_deptno,\n    k.benefitDeptno AS benefit_deptno,\n    k.period AS period,\n    k.projApplyRespEmpno AS proj_apply_resp_empno,\n    k.projApplyWriter AS proj_apply_writer,\n    k.isProjplan AS is_projplan,\n    k.projplanno AS proj_plan_no,\n    k.projType AS proj_type,\n    k.isBenefit AS is_benefit,\n    k.ispost AS is_post,\n    k.posts AS posts,\n    k.currntSituation AS currnt_situation,\n    k.reason AS reason,\n    k.mainContent AS main_content,\n    k.relevantContent AS relevant_content,\n    k.itDemand AS it_demand,\n    k.energyDemand AS energy_demand,\n    k.status AS status,\n    k.applyDate AS apply_date,\n    k.applyTime AS apply_time,\n    k.issueEmpNo AS issue_emp_no,\n    k.isaddtoproof AS is_add_to_proof,\n    k.aimcimp1no AS aim_cimp1_no,\n    k.creative AS creative,\n    k.isNewPlan AS is_new_plan\nFROM\n    dwi_eqp.dwi_eqp_tbcima2_lz c2\nLEFT JOIN\n    dwi_eqp.dwi_eqp_tbciabudget_lz cb\n    ON c2.cima2id = cb.relateId\nLEFT JOIN\n    dwi_eqp.dwi_eqp_tbcima6_lz c6\n    ON c2.cima2id = c6.cima2id\nLEFT JOIN\n    dwi_eqp.dwi_eqp_tbcima2b_lz c2b\n    ON c2.projectplanname = c2b.projectplanname \n    AND c2.particularYear = c2b.particularYear\n    AND c2.businessUnit = c2b.businessUnit\nLEFT JOIN\n    dwi_eqp.dwi_eqp_tbkea01_lz k\n    ON c2.projectplanname = k.projApplyName;\n-- SELECT count(1) FROM dwi_eqp.dwi_eqp_lz_engineering_project_full_process;",
	"currentDatabase":"dwi_eqp",
	"description":"",
	"directory":"/廉政专项/工程管理/宽表",
	"name":"etl_dwi_eqp_lz_engineering_project_full_process",
	"templateVersion":"1.0",
	"type":"SparkSQL"
}