{
	"configuration":{},
	"connectionName":"MRS_Spark_Agent",
	"content":"-- SPARK sql \n-- ******************************************************************** --\n-- author: jh_caiyi\n-- create time: 2025-07-03\n-- descr: 廉政八项-检化验专线-检化验数据全流程宽表\n-- ******************************************************************** --\n-- DROP TABLE IF EXISTS dwi_qlt.dwi_qlt_full_inspection_data;\n-- CREATE TABLE\n-- \tdwi_qlt.dwi_qlt_full_inspection_data (\n-- \t\t-- tx_sampinfo 字段 (制样、留样、取样信息)\n-- \t\tmanu_no STRING COMMENT '自编号',\n-- \t\tvehicle2num STRING COMMENT '转运车船号',\n-- \t\ttransit_no STRING COMMENT '中转站',\n-- \t\tauto_mk STRING COMMENT '制样方式(自动、手动)',\n-- \t\tsmp_mk_std STRING COMMENT '制样标准',\n-- \t\tconveyance STRING COMMENT '运输方式',\n-- \t\tvehicle1num STRING COMMENT '原始车船号',\n-- \t\twarn_time STRING COMMENT '预警时间',\n-- \t\twarn_date STRING COMMENT '预警日期',\n-- \t\tsmp_mk_time_ym STRING COMMENT '研磨制样时间(研磨)',\n-- \t\tsmp_mk_date_ym STRING COMMENT '研磨制样日期(研磨)',\n-- \t\tsmp_maker_ym STRING COMMENT '研磨制样人(研磨)',\n-- \t\tupd_time STRING COMMENT '修改时间',\n-- \t\tupd_date STRING COMMENT '修改日期',\n-- \t\tupd_emp STRING COMMENT '修改人',\n-- \t\tinfo_source STRING COMMENT '信息来源',\n-- \t\tmtrl_no STRING COMMENT '物料牌号代码',\n-- \t\tsub_mat_no STRING COMMENT '物料类别代码',\n-- \t\ttrust_lab STRING COMMENT '委托实验室',\n-- \t\ttrustdeed_no STRING COMMENT '委托单号/钢铁站铁水重量',\n-- \t\tflag STRING COMMENT '完成标志',\n-- \t\tins_time STRING COMMENT '添加时间',\n-- \t\tins_date STRING COMMENT '添加日期',\n-- \t\tins_shift STRING COMMENT '添加人班次',\n-- \t\tins_emp STRING COMMENT '添加人',\n-- \t\tweather STRING COMMENT '天气状况',\n-- \t\tsmp_send_time STRING COMMENT '送样时间',\n-- \t\tsmp_send_day STRING COMMENT '送样日期',\n-- \t\tsmp_sender2 STRING COMMENT '送样人2',\n-- \t\tsmp_sender STRING COMMENT '送样人',\n-- \t\twater_box STRING COMMENT '水分盘号',\n-- \t\tquantity STRING COMMENT '数量',\n-- \t\tconfirm_time STRING COMMENT '数据确认时间',\n-- \t\tconfirm_date STRING COMMENT '数据确认日期',\n-- \t\tsmp_type STRING COMMENT '试样类型',\n-- \t\tsmp_process STRING COMMENT '试样进程',\n-- \t\tsmp_no STRING COMMENT '试样号',\n-- \t\tis_prt STRING COMMENT '是否结算N结算 D 未结算默认(D)',\n-- \t\tuse_dept_no STRING COMMENT '使用单位代码',\n-- \t\texperiment STRING COMMENT '实验',\n-- \t\tjudg_upd STRING COMMENT '审核修改人',\n-- \t\tjudg_time STRING COMMENT '审核时间',\n-- \t\tjudg_day STRING COMMENT '审核日期',\n-- \t\tjudge_shift STRING COMMENT '审核人班次',\n-- \t\tjudge_crew STRING COMMENT '审核人班别',\n-- \t\tjudgeer STRING COMMENT '审核人',\n-- \t\tjudg_desc STRING COMMENT '审核结果描述',\n-- \t\tjudg_rst STRING COMMENT '审核结果',\n-- \t\tget_smp_time STRING COMMENT '取样时间',\n-- \t\tget_smp_day STRING COMMENT '取样日期',\n-- \t\tget_smp2 STRING COMMENT '取样人2',\n-- \t\tget_smp STRING COMMENT '取样人',\n-- \t\tsampling_time STRING COMMENT '取样确认时间',\n-- \t\tsampling_date STRING COMMENT '取样确认日期',\n-- \t\tsmp_site_no STRING COMMENT '取样地点代码',\n-- \t\tsmp_get_std STRING COMMENT '取样标准',\n-- \t\tget_smp_grp STRING COMMENT '取样班组',\n-- \t\tsmp_mk_time STRING COMMENT '制样时间(破碎缩分)',\n-- \t\tsmp_mk_date STRING COMMENT '制样日期(破碎缩分)',\n-- \t\tsmp_maker STRING COMMENT '制样人(破碎缩分)',\n-- \t\tdsc_flag STRING COMMENT '判定标准,(A料号标准,B合同标准)',\n-- \t\tin_curve STRING COMMENT '能源中心接口标识',\n-- \t\tupdate_emp STRING COMMENT '盲样修改人',\n-- \t\theat_no STRING COMMENT '炉次号',\n-- \t\tsmp_stay_box STRING COMMENT '留样盒号',\n-- \t\tin_report STRING COMMENT '炼铁新厂接口标识',\n-- \t\timpurities_wgt STRING COMMENT '扣杂重量',\n-- \t\tsmp_receiver STRING COMMENT '接样人',\n-- \t\tinspempl_no STRING COMMENT '检验站编号',\n-- \t\tcheckno STRING COMMENT '检验批号',\n-- \t\tjudg_time3 STRING COMMENT '检测站审核时间',\n-- \t\tjudg_day3 STRING COMMENT '检测站审核日期',\n-- \t\tjudgeer3 STRING COMMENT '检测站审核人',\n-- \t\tmakecheck_flag STRING COMMENT '检测站审核标记',\n-- \t\tsend_time STRING COMMENT '发送时间(检测站送检验时间)',\n-- \t\tsend_day STRING COMMENT '发送日期(检测站送检验日期)',\n-- \t\tsend_emp STRING COMMENT '发送人员(检测站送检验人员工号)',\n-- \t\tmeasure_unit STRING COMMENT '计量单位/钢铁站是否并罐Y并罐,V,N非并罐',\n-- \t\treceive_time STRING COMMENT '样品接收时间(化验站接收样品时间)',\n-- \t\treceive_day STRING COMMENT '样品接收日期(化验站接收样品日期)',\n-- \t\treceive_emp STRING COMMENT '样品接收人员(化验站接收样品人员工号)',\n-- \t\tcontract_no STRING COMMENT '合同号',\n-- \t\tsmp_site_area STRING COMMENT '合金取样区域',\n-- \t\trelat_no STRING COMMENT '关联号',\n-- \t\tprovid_no STRING COMMENT '供应商代码',\n-- \t\tretest_flag STRING COMMENT '复样标识',\n-- \t\tnode_type STRING COMMENT '复合板类型',\n-- \t\tanaly_type STRING COMMENT '分析类型',\n-- \t\tshipping_company STRING COMMENT '发货厂商代码',\n-- \t\tget_smp_cnt STRING COMMENT '第几次样',\n-- \t\tprt_time STRING COMMENT '打印时间',\n-- \t\tprt_date STRING COMMENT '打印日期',\n-- \t\tprt_emp STRING COMMENT '打印人',\n-- \t\tprd_area STRING COMMENT '产地',\n-- \t\tjoin_virsmp STRING COMMENT '参与虚拟样生成',\n-- \t\tremark STRING COMMENT '备注1',\n-- \t\tnote STRING COMMENT '备注',\n-- \t\texpected STRING COMMENT 'SiO2理论值',\n-- \t\tsmp_date_start STRING COMMENT '取样开始日期',\n-- \t\tsmp_time_start STRING COMMENT '取样开始时间',\n-- \t\tget_smp_status STRING COMMENT '取样状态',\n-- \t\tcomp_smp_flag STRING COMMENT '复合样标志',\n-- \t\tsam_checkno STRING COMMENT '样品检验批号',\n-- \t\tbsamp_submat STRING COMMENT '基础样品物料',\n-- \t\tmk_rcv_date STRING COMMENT '制样接收日期',\n-- \t\tmk_rcv_time STRING COMMENT '制样接收时间',\n-- \t\tmk_upd_date STRING COMMENT '制样更新日期',\n-- \t\tmk_upd_time STRING COMMENT '制样更新时间',\n-- \t\tmk_upd_emp STRING COMMENT '制样更新人',\n-- \t\tmk_flag STRING COMMENT '制样标志',\n-- \t\twarranty_verify STRING COMMENT '质保验证',\n-- \t\tsmp_startget_day STRING COMMENT '取样开始日期',\n-- \t\tsmp_startget_time STRING COMMENT '取样开始时间',\n-- \t\tsmp_startget_emp STRING COMMENT '取样开始人员',\n-- \t\t-- tx_analyresult 字段 (检验数据)\n-- \t\ttest_min STRING COMMENT '最小值',\n-- \t\ttest_max STRING COMMENT '最大值',\n-- \t\ttest_rst_rd STRING COMMENT '修约结果',\n-- \t\tanaly_flag STRING COMMENT '完成标志(检验数据)',\n-- \t\ttest_std_no STRING COMMENT '试验标准编号',\n-- \t\tanaly_experiment STRING COMMENT '实验(检验数据)',\n-- \t\ttester STRING COMMENT '检验员',\n-- \t\tsmp_item_seq STRING COMMENT '检验项目顺序',\n-- \t\tsmp_item STRING COMMENT '检验项目',\n-- \t\tsmp_time STRING COMMENT '检验时间',\n-- \t\ttest_eqt_no STRING COMMENT '检验设备',\n-- \t\tsmp_date STRING COMMENT '检验日期',\n-- \t\ttest_rst STRING COMMENT '检验结果',\n-- \t\tanaly_retest_flag STRING COMMENT '复样标识(检验数据)',\n-- \t\tmakeflag STRING COMMENT '防作弊系统制样物性数据录入界面完成标志',\n-- \t\tmat_std STRING COMMENT '等级',\n-- \t\ttest_std STRING COMMENT '操作规程',\n-- \t\ttest_shift STRING COMMENT '班次',\n-- \t\ttest_crew STRING COMMENT '班别',\n-- \t\tanaly_sam_checkno STRING COMMENT '样品检验批号(检验数据)',\n-- \t\tanaly_warranty_verify STRING COMMENT '质保验证(检验数据)',\n-- \t\tspec_rulle STRING COMMENT '规格规则',\n-- \t\t-- TBMRIFCP 字段 (验收批次化物性档)\n-- \t\tcomp_id STRING COMMENT '公司别',\n-- \t\tchk_no STRING COMMENT '检验批号(TBMRIFCP)',\n-- \t\tchk_type STRING COMMENT '检验种类',\n-- \t\tchk_item STRING COMMENT '检验项目(TBMRIFCP)',\n-- \t\tchk_ver STRING COMMENT '检验版本号',\n-- \t\tlv1_up DECIMAL(8,4) COMMENT '一级品上限',\n-- \t\tlv1_down DECIMAL(8,4) COMMENT '一级品下限',\n-- \t\tseq_no STRING COMMENT '项目序号',\n-- \t\tscale DECIMAL(1,0) COMMENT '位数',\n-- \t\tsupply_spec DECIMAL(8,4) COMMENT '供货商规格',\n-- \t\tscale_spec DECIMAL(8,4) COMMENT '商检规格',\n-- \t\tco_spec DECIMAL(8,4) COMMENT '公司规格',\n-- \t\tco1_spec DECIMAL(8,4) COMMENT '公司初检规格',\n-- \t\tco2_spec DECIMAL(8,4) COMMENT '公司复检规格',\n-- \t\tco3_spec DECIMAL(8,4) COMMENT '仲裁规格',\n-- \t\tgrade STRING COMMENT '级别',\n-- \t\tsub_coin DECIMAL(6,2) COMMENT '扣款额度',\n-- \t\tqty_rslt STRING COMMENT '检验结果(TBMRIFCP)',\n-- \t\tcrat_no STRING COMMENT '数据建立人',\n-- \t\tcrat_date STRING COMMENT '数据建立日期',\n-- \t\tlast_revs_no STRING COMMENT '上次资料更动人',\n-- \t\tlast_revs_date STRING COMMENT '上次数据更动日期',\n-- \t\tlast_revs_no_a STRING COMMENT '上次资料更动人A',\n-- \t\tlast_revs_date_a STRING COMMENT '上次数据更动日期A',\n-- \t\tlast_revs_no_b STRING COMMENT '上次资料更动人B',\n-- \t\tlast_revs_date_b STRING COMMENT '上次数据更动日期B',\n-- \t\tlast_revs_no_c STRING COMMENT '上次资料更动人C',\n-- \t\tlast_revs_date_c STRING COMMENT '上次数据更动日期C',\n-- \t\ttbmrifcp_remark STRING COMMENT '备注(TBMRIFCP)',\n-- \t\tis_qualified STRING COMMENT '是否合格',\n-- \t\tquality_id STRING COMMENT '南钢质检质量异议复检id',\n-- \t\tarbitration_id STRING COMMENT '南钢质检质量异议仲裁id',\n-- \t\tsupp_quality_id STRING COMMENT '供应商质检质量异议复检id',\n-- \t\tsupp_arbitration_id STRING COMMENT '供应商质检质量异议仲裁id',\n-- \t\t-- TX_QUALITY_OBJECTION 字段 (质量异议下抛信息)\n-- \t\tquality_no STRING COMMENT '申请单号',\n-- \t\tquality_check_no STRING COMMENT '检验批号(质量异议)',\n-- \t\tmtrl_no_quality STRING COMMENT '物料代码(质量异议)',\n-- \t\tquality_contract_no STRING COMMENT '合同号(质量异议)',\n-- \t\tcompany_id_quality STRING COMMENT '供应商代码(质量异议)',\n-- \t\tretest_kind STRING COMMENT '复检类型A(不合格复检)，B(质保书复检)',\n-- \t\tretest_function STRING COMMENT '复检方式',\n-- \t\ttrack_flag STRING COMMENT '跟踪',\n-- \t\tband_sample_flag STRING COMMENT '带样',\n-- \t\tretest_item STRING COMMENT '复检项目',\n-- \t\tins_date_quality STRING COMMENT '新增日期(质量异议)',\n-- \t\tins_time_quality STRING COMMENT '新增时间(质量异议)'\n-- \t) COMMENT '检化验数据全流程宽表' STORED AS orc TBLPROPERTIES (\"orc.compress\" = \"SNAPPY\");\n-- DROP VIEW IF EXISTS ods_nqis.ods_nqis_tx_sampinfo_f_view;\n-- CREATE VIEW ods_nqis.ods_nqis_tx_sampinfo_f_view AS \n-- SELECT * FROM ods_nqis.ods_nqis_tx_sampinfo_f WHERE dt=current_date-1 LIMIT 20;\n-- DROP VIEW IF EXISTS ods_nqis.ods_nqis_tx_analyresult_f_view;\n-- CREATE VIEW ods_nqis.ods_nqis_tx_analyresult_f_view AS \n-- SELECT * FROM ods_nqis.ods_nqis_tx_sampinfo_f WHERE dt=current_date-1;\nTRUNCATE TABLE dwi_qlt.dwi_qlt_full_inspection_data;\nINSERT OVERWRITE TABLE\n\tdwi_qlt.dwi_qlt_full_inspection_data\nSELECT\n\t-- tx_sampinfo 字段 (制样、留样、取样信息)\n\ts.manu_no, -- 自编号\n\ts.vehicle2num, -- 转运车船号\n\ts.transit_no, -- 中转站\n\ts.auto_mk, -- 制样方式(自动、手动)\n\ts.smp_mk_std, -- 制样标准\n\ts.conveyance, -- 运输方式\n\ts.vehicle1num, -- 原始车船号\n\ts.warn_time, -- 预警时间\n\ts.warn_date, -- 预警日期\n\ts.smp_mk_time_ym, -- 研磨制样时间(研磨)\n\ts.smp_mk_date_ym, -- 研磨制样日期(研磨)\n\ts.smp_maker_ym, -- 研磨制样人(研磨)\n\ts.upd_time, -- 修改时间\n\ts.upd_date, -- 修改日期\n\ts.upd_emp, -- 修改人\n\ts.info_source, -- 信息来源\n\ts.mtrl_no, -- 物料牌号代码\n\ts.sub_mat_no, -- 物料类别代码\n\ts.trust_lab, -- 委托实验室\n\ts.trustdeed_no, -- 委托单号/钢铁站铁水重量\n\ts.flag, -- 完成标志\n\ts.ins_time, -- 添加时间\n\ts.ins_date, -- 添加日期\n\ts.ins_shift, -- 添加人班次\n\ts.ins_emp, -- 添加人\n\ts.weather, -- 天气状况\n\ts.smp_send_time, -- 送样时间\n\ts.smp_send_day, -- 送样日期\n\ts.smp_sender2, -- 送样人2\n\ts.smp_sender, -- 送样人\n\ts.water_box, -- 水分盘号\n\ts.quantity, -- 数量\n\ts.confirm_time, -- 数据确认时间\n\ts.confirm_date, -- 数据确认日期\n\ts.smp_type, -- 试样类型\n\ts.smp_process, -- 试样进程\n\ts.smp_no, -- 试样号\n\ts.is_prt, -- 是否结算N结算 D 未结算默认(D)\n\ts.use_dept_no, -- 使用单位代码\n\ts.experiment, -- 实验\n\ts.judg_upd, -- 审核修改人\n\ts.judg_time, -- 审核时间\n\ts.judg_day, -- 审核日期\n\ts.judge_shift, -- 审核人班次\n\ts.judge_crew, -- 审核人班别\n\ts.judgeer, -- 审核人\n\ts.judg_desc, -- 审核结果描述\n\ts.judg_rst, -- 审核结果\n\ts.get_smp_time, -- 取样时间\n\ts.get_smp_day, -- 取样日期\n\ts.get_smp2, -- 取样人2\n\ts.get_smp, -- 取样人\n\ts.sampling_time, -- 取样确认时间\n\ts.sampling_date, -- 取样确认日期\n\ts.smp_site_no, -- 取样地点代码\n\ts.smp_get_std, -- 取样标准\n\ts.get_smp_grp, -- 取样班组\n\ts.smp_mk_time, -- 制样时间(破碎缩分)\n\ts.smp_mk_date, -- 制样日期(破碎缩分)\n\ts.smp_maker, -- 制样人(破碎缩分)\n\ts.dsc_flag, -- 判定标准,(A料号标准,B合同标准)\n\ts.in_curve, -- 能源中心接口标识\n\ts.update_emp, -- 盲样修改人\n\ts.heat_no, -- 炉次号\n\ts.smp_stay_box, -- 留样盒号\n\ts.in_report, -- 炼铁新厂接口标识\n\ts.impurities_wgt, -- 扣杂重量\n\ts.smp_receiver, -- 接样人\n\ts.inspempl_no, -- 检验站编号\n\ts.checkno, -- 检验批号\n\ts.judg_time3, -- 检测站审核时间\n\ts.judg_day3, -- 检测站审核日期\n\ts.judgeer3, -- 检测站审核人\n\ts.makecheck_flag, -- 检测站审核标记\n\ts.send_time, -- 发送时间(检测站送检验时间)\n\ts.send_day, -- 发送日期(检测站送检验日期)\n\ts.send_emp, -- 发送人员(检测站送检验人员工号)\n\ts.measure_unit, -- 计量单位/钢铁站是否并罐Y并罐,V,N非并罐\n\ts.receive_time, -- 样品接收时间(化验站接收样品时间)\n\ts.receive_day, -- 样品接收日期(化验站接收样品日期)\n\ts.receive_emp, -- 样品接收人员(化验站接收样品人员工号)\n\ts.contract_no, -- 合同号\n\ts.smp_site_area, -- 合金取样区域\n\ts.relat_no, -- 关联号\n\ts.provid_no, -- 供应商代码\n\ts.retest_flag, -- 复样标识\n\ts.node_type, -- 复合板类型\n\ts.analy_type, -- 分析类型\n\ts.shipping_company, -- 发货厂商代码\n\ts.get_smp_cnt, -- 第几次样\n\ts.prt_time, -- 打印时间\n\ts.prt_date, -- 打印日期\n\ts.prt_emp, -- 打印人\n\ts.prd_area, -- 产地\n\ts.join_virsmp, -- 参与虚拟样生成\n\ts.remark, -- 备注1\n\ts.note, -- 备注\n\ts.expected, -- SiO2理论值\n\ts.smp_date_start, -- 取样开始日期\n\ts.smp_time_start, -- 取样开始时间\n\ts.get_smp_status, -- 取样状态\n\ts.comp_smp_flag, -- 复合样标志\n\ts.sam_checkno, -- 样品检验批号\n\ts.bsamp_submat, -- 基础样品物料\n\ts.mk_rcv_date, -- 制样接收日期\n\ts.mk_rcv_time, -- 制样接收时间\n\ts.mk_upd_date, -- 制样更新日期\n\ts.mk_upd_time, -- 制样更新时间\n\ts.mk_upd_emp, -- 制样更新人\n\ts.mk_flag, -- 制样标志\n\ts.warranty_verify, -- 质保验证\n\ts.smp_startget_day, -- 取样开始日期\n\ts.smp_startget_time, -- 取样开始时间\n\ts.smp_startget_emp, -- 取样开始人员\n\t-- tx_analyresult 字段 (检验数据)\n\t'',--a.test_min, -- 最小值\n\t'',--a.test_max, -- 最大值\n\t'',--a.test_rst_rd, -- 修约结果\n\ta.flag AS analy_flag, -- 完成标志(检验数据)\n\t'',--a.test_std_no, -- 试验标准编号\n\ta.experiment AS analy_experiment, -- 实验(检验数据)\n\t'',--a.tester, -- 检验员\n\t'',--a.smp_item_seq, -- 检验项目顺序\n\ta.smp_item, -- 检验项目\n\ta.smp_time, -- 检验时间\n\ta.test_eqt_no, -- 检验设备\n\ta.smp_date, -- 检验日期\n\ta.test_rst, -- 检验结果\n\ta.retest_flag AS analy_retest_flag, -- 复样标识(检验数据)\n\ta.makeflag, -- 防作弊系统制样物性数据录入界面完成标志\n\ta.mat_std, -- 等级\n\ta.test_std, -- 操作规程\n\ta.test_shift, -- 班次\n\ta.test_crew, -- 班别\n\ta.sam_checkno AS analy_sam_checkno, -- 样品检验批号(检验数据)\n\ta.warranty_verify AS analy_warranty_verify, -- 质保验证(检验数据)\n\ta.spec_rulle, -- 规格规则\n\t-- TBMRIFCP 字段 (验收批次化物性档)\n\tt.CompId AS comp_id, -- 公司别\n\tt.ChkNo AS chk_no, -- 检验批号(TBMRIFCP)\n\tt.ChkType AS chk_type, -- 检验种类\n\tt.ChkItem AS chk_item, -- 检验项目(TBMRIFCP)\n\tt.ChkVer AS chk_ver, -- 检验版本号\n\tt.Lv1Up AS lv1_up, -- 一级品上限\n\tt.Lv1Down AS lv1_down, -- 一级品下限\n\tt.SeqNo AS seq_no, -- 项目序号\n\tt.Scale AS scale, -- 位数\n\tt.SupplySpec AS supply_spec, -- 供货商规格\n\tt.ScaleSpec AS scale_spec, -- 商检规格\n\tt.CoSpec AS co_spec, -- 公司规格\n\tt.Co1Spec AS co1_spec, -- 公司初检规格\n\tt.Co2Spec AS co2_spec, -- 公司复检规格\n\tt.Co3Spec AS co3_spec, -- 仲裁规格\n\tt.Grade AS grade, -- 级别\n\tt.SubCoin AS sub_coin, -- 扣款额度\n\tt.QtyRslt AS qty_rslt, -- 检验结果(TBMRIFCP)\n\tt.CratNo AS crat_no, -- 数据建立人\n\tt.CratDate AS crat_date, -- 数据建立日期\n\tt.LastRevsNo AS last_revs_no, -- 上次资料更动人\n\tt.LastRevsDate AS last_revs_date, -- 上次数据更动日期\n\tt.LastRevsNoA AS last_revs_no_a, -- 上次资料更动人A\n\tt.LastRevsDateA AS last_revs_date_a, -- 上次数据更动日期A\n\tt.LastRevsNoB AS last_revs_no_b, -- 上次资料更动人B\n\tt.LastRevsDateB AS last_revs_date_b, -- 上次数据更动日期B\n\tt.LastRevsNoC AS last_revs_no_c, -- 上次资料更动人C\n\tt.LastRevsDateC AS last_revs_date_c, -- 上次数据更动日期C\n\tt.ReMark AS tbmrifcp_remark, -- 备注(TBMRIFCP)\n\tt.ISQUALIFIED AS is_qualified, -- 是否合格\n\tt.QUALITYID AS quality_id, -- 南钢质检质量异议复检id\n\tt.ArbitrationId AS arbitration_id, -- 南钢质检质量异议仲裁id\n\tt.SUPPQUALITYID AS supp_quality_id, -- 供应商质检质量异议复检id\n\tt.SUPPArbitrationId AS supp_arbitration_id, -- 供应商质检质量异议仲裁id\n\t-- TX_QUALITY_OBJECTION 字段 (质量异议下抛信息)\n\tq.QUALITY_NO AS quality_no, -- 申请单号\n\tq.CHECK_NO AS quality_check_no, -- 检验批号(质量异议)\n\tq.MTRL_NO AS mtrl_no_quality, -- 物料代码(质量异议)\n\tq.CONTRACT_NO AS quality_contract_no, -- 合同号(质量异议)\n\tq.COMPANY_ID AS company_id_quality, -- 供应商代码(质量异议)\n\tq.RETEST_KIND AS retest_kind, -- 复检类型A(不合格复检)，B(质保书复检)\n\tq.RETEST_FUNCTION AS retest_function, -- 复检方式\n\tq.TRACK_FLAG AS track_flag, -- 跟踪\n\tq.BAND_SAMPLE_FLAG AS band_sample_flag, -- 带样\n\tq.RETEST_ITEM AS retest_item, -- 复检项目\n\tq.INS_DATE AS ins_date_quality, -- 新增日期(质量异议)\n\tq.INS_TIME AS ins_time_quality -- 新增时间(质量异议)\nFROM\ndwi_qlt.dwi_qlt_tx_sampinfo_lz s\nLEFT JOIN\ndwi_qlt.dwi_qlt_tx_analyresult_lz a\nON\n\ts.smp_no = a.smp_no AND s.heat_no = a.heat_no AND s.smp_type = a.smp_type\nLEFT JOIN\n\tdwi_qlt.dwi_qlt_tbmrifcp_lz t\nON\n\ts.checkno = t.ChkNo\nLEFT JOIN\n\tdwi_qlt.dwi_qlt_tx_quality_objection_lz q\nON\n\ts.checkno = q.CHECK_NO where s.ins_date>'20250601';\n\t\n\t\n-- \tSELECT count(1) FROM dwi_qlt.dwi_qlt_tx_sampinfo_lz;\n-- \tSELECT checkno,smp_no,heat_no,smp_type,checkno,ins_date FROM dwi_qlt.dwi_qlt_tx_sampinfo_lz where smp_no='Y0100021SP738637' AND ins_date='20250602' LIMIT 10;\n-- \tSELECT count(1) FROM dwi_qlt.dwi_qlt_tx_analyresult_lz;\n-- \tSELECT count(1) FROM dwi_qlt.dwi_qlt_tx_analyresult_lz where smp_no IS NOT NULL AND heat_no IS NOT NULL AND smp_type IS NOT NULL \n-- \tSELECT * FROM dwi_qlt.dwi_qlt_tx_analyresult_lz WHERE smp_no='Y0100021SP738637'\n-- \tSELECT * FROM dwi_qlt.dwi_qlt_tbmrifcp_lz WHERE CHECK_NO='S2505C0010'\n-- \tSELECT count(1) FROM dwi_qlt.dwi_qlt_tbmrifcp_lz;\n-- \tSELECT count(1) FROM dwi_qlt.dwi_qlt_tx_quality_objection_lz;\n-- -- \twhere s.smp_no='B1BH211';\n",
	"currentDatabase":"dwi_qlt",
	"description":"",
	"directory":"/廉政专项/检化验/宽表",
	"name":"etl_dwi_qlt_lz_full_inspection_data",
	"templateVersion":"1.0",
	"type":"SparkSQL"
}