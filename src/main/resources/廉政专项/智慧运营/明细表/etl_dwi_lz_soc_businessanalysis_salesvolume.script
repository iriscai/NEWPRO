{
	"configuration":{},
	"connectionName":"MRS_Spark_Agent",
	"content":"-- ******************************************************************** --\n-- author: jh_caiyi\n-- create time: 2025-07-15\n-- descr: 廉政八项-智慧运营中心-销售量数据明细\n-- ******************************************************************** --\n-- DROP TABLE IF EXISTS dwi_prc.dwi_prc_lz_soc_businessanalysis_salesvolume;\n-- CREATE TABLE\n--     dwi_prc.dwi_prc_lz_soc_businessanalysis_salesvolume (\n--     optype STRING COMMENT '板材/特钢',\n-- iacctcode STRING,\n-- lcunitprice STRING,\n-- beginlocno STRING,\n-- memo STRING,\n-- lcduedate STRING,\n-- lcfrnamt STRING,\n-- prodvicecode STRING,\n-- revenuepn STRING,\n-- datatypeno STRING,\n-- raisepriceid STRING,\n-- dispsalestype STRING,\n-- standardpriceid STRING,\n-- transway STRING,\n-- recno STRING,\n-- orderreqdate STRING,\n-- reducepriceid STRING,\n-- frntaxamt STRING,\n-- reasoncode STRING,\n-- packfee STRING,\n-- orderunitprice STRING,\n-- ordermonth STRING,\n-- salesid STRING,\n-- valuation STRING,\n-- carno STRING,\n-- orderthick STRING,\n-- ordertype STRING,\n-- packwet STRING,\n-- lcno STRING,\n-- collectmode STRING,\n-- deliqty STRING,\n-- factoryline STRING,\n-- compid STRING,\n-- contchannel STRING,\n-- currency STRING,\n-- orderwidth STRING,\n-- lctaiamt STRING,\n-- vchrdate STRING,\n-- contractno STRING,\n-- loadingway STRING,\n-- customsno STRING,\n-- orderway STRING,\n-- guaranteeamt STRING,\n-- lccrcyunit STRING,\n-- orderno STRING,\n-- discountwet STRING,\n-- invoicenoe STRING,\n-- deliwet STRING,\n-- salesunit STRING,\n-- vchrno STRING,\n-- deliveryno STRING,\n-- endlocno STRING,\n-- labelno STRING,\n-- sizeunit STRING,\n-- salesarea STRING,\n-- lcexchange STRING,\n-- artimestamp STRING,\n-- taxunitprice STRING,\n-- taxrate STRING,\n-- transcompid STRING,\n-- transportwaytype STRING,\n-- lastproddate STRING,\n-- qualityclass STRING,\n-- apnno STRING,\n-- coilno STRING,\n-- transunitprice STRING,\n-- psrno STRING,\n-- orderlength STRING,\n-- transtoolno STRING,\n-- displistdate STRING,\n-- oemvencode STRING,\n-- exchange STRING,\n-- taxamt STRING,\n-- recnoitem STRING,\n-- prodno STRING,\n-- interestamt STRING,\n-- custno STRING,\n-- arstatus STRING,\n-- datacreatedate STRING,\n-- transcost STRING,\n-- taxtype STRING,\n-- revenueno STRING,\n-- orderitem STRING,\n-- discountqty STRING,\n-- prodclass STRING,\n-- interest STRING,\n-- taiamt STRING,\n-- stove STRING,\n-- shipdate STRING,\n-- factory STRING,\n-- prodcode STRING,\n-- specmark STRING,\n-- datacreatetime STRING,\n-- displistno STRING,\n-- label STRING,\n-- frnamt STRING,\n-- prortype STRING,\n-- packfeeb STRING,\n-- packfeea STRING,\n-- salesregion STRING,\n-- invoiceno STRING,\n-- lctaxamt STRING,\n-- invoicedate STRING,\n-- \t\tetl_date DATE \n--     )\n-- COMMENT '廉政八项-智慧运营中心-销售量数据明细'\n-- PARTITIONED BY (mt STRING COMMENT '分区月份')\n-- STORED AS ORC;\nINSERT OVERWRITE TABLE\n\tdwi_prc.dwi_prc_lz_soc_businessanalysis_salesvolume PARTITION (mt = '202507')\n-- 板材当月：\nSELECT '板材' AS optype,a.iacctcode,a.lcunitprice,a.beginlocno,a.memo,a.lcduedate,a.lcfrnamt,a.prodvicecode,a.revenuepn,a.datatypeno,a.raisepriceid,a.dispsalestype,a.standardpriceid,a.transway,a.recno,a.orderreqdate,a.reducepriceid,a.frntaxamt,a.reasoncode,a.packfee,a.orderunitprice,a.ordermonth,a.salesid,a.valuation,a.carno,a.orderthick,a.ordertype,a.packwet,a.lcno,a.collectmode,a.deliqty,a.factoryline,a.compid,a.contchannel,a.currency,a.orderwidth,a.lctaiamt,a.vchrdate,a.contractno,a.loadingway,a.customsno,a.orderway,a.guaranteeamt,a.lccrcyunit,a.orderno,a.discountwet,a.invoicenoe,a.deliwet,a.salesunit,a.vchrno,a.deliveryno,a.endlocno,a.labelno,a.sizeunit,a.salesarea,a.lcexchange,a.artimestamp,a.taxunitprice,a.taxrate,a.transcompid,a.transportwaytype,a.lastproddate,a.qualityclass,a.apnno,a.coilno,a.transunitprice,a.psrno,a.orderlength,a.transtoolno,a.displistdate,a.oemvencode,a.exchange,a.taxamt,a.recnoitem,a.prodno,a.interestamt,a.custno,a.arstatus,a.datacreatedate,a.transcost,a.taxtype,a.revenueno,a.orderitem,a.discountqty,a.prodclass,a.interest,a.taiamt,a.stove,a.shipdate,a.factory,a.prodcode,a.specmark,a.datacreatetime,a.displistno,a.label,a.frnamt,a.prortype,a.packfeeb,a.packfeea,a.salesregion,a.invoiceno,a.lctaxamt,a.invoicedate, CURRENT_DATE()                -- 当前日期\nFROM\n\tdwi_log.dwi_log_tbss15 a\n\tLEFT JOIN dwi_log.dwi_log_tbsonj011 b ON a.orderno = b.orderno\nWHERE\n\tSUBSTR(DATACREATEDATE, 1, 4) = SUBSTR(CURRENT_DATE(), 1, 4)\n\tAND a.SALESUNIT NOT IN ('M8', 'M6', 'MZ', 'M9', 'D5')\n\tAND a.SALESUNIT LIKE 'M%'\n\tAND a.ORDERNO NOT LIKE 'C%'\n\tAND PRODCODE IN ('HPR', 'HPT', 'HCR', 'HFR', 'HFT')\n\tAND orderkind IN ('B', 'I')\nUNION ALL\n-- 特钢当月：\nSELECT\n\t'特钢' AS optype,iacctcode,lcunitprice,beginlocno,memo,lcduedate,lcfrnamt,prodvicecode,revenuepn,datatypeno,raisepriceid,dispsalestype,standardpriceid,transway,recno,orderreqdate,reducepriceid,frntaxamt,reasoncode,packfee,orderunitprice,ordermonth,salesid,valuation,carno,orderthick,ordertype,packwet,lcno,collectmode,deliqty,factoryline,compid,contchannel,currency,orderwidth,lctaiamt,vchrdate,contractno,loadingway,customsno,orderway,guaranteeamt,lccrcyunit,orderno,discountwet,invoicenoe,deliwet,salesunit,vchrno,deliveryno,endlocno,labelno,sizeunit,salesarea,lcexchange,artimestamp,taxunitprice,taxrate,transcompid,transportwaytype,lastproddate,qualityclass,apnno,coilno,transunitprice,psrno,orderlength,transtoolno,displistdate,oemvencode,exchange,taxamt,recnoitem,prodno,interestamt,custno,arstatus,datacreatedate,transcost,taxtype,revenueno,orderitem,discountqty,prodclass,interest,taiamt,stove,shipdate,factory,prodcode,specmark,datacreatetime,displistno,label,frnamt,prortype,packfeeb,packfeea,salesregion,invoiceno,lctaxamt,invoicedate,CURRENT_DATE()                -- 当前日期\nFROM\n\tdwi_log.dwi_log_tbss15\nWHERE\n\tSUBSTR(DATACREATEDATE, 1, 4) = SUBSTR(CURRENT_DATE(), 1, 4)\n\tAND SALESUNIT NOT IN ('S2', 'S6', 'M8')\n\tAND ORDERNO NOT LIKE 'C%'\n\tAND PRODCODE IN ('HBR', 'HTR', 'HWR');",
	"currentDatabase":"dwi_qlt",
	"description":"",
	"directory":"/廉政专项/智慧运营/明细表",
	"name":"etl_dwi_lz_soc_businessanalysis_salesvolume",
	"templateVersion":"1.0",
	"type":"SparkSQL"
}