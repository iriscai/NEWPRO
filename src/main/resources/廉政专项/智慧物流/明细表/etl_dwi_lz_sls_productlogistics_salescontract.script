{
	"configuration":{},
	"connectionName":"MRS_Spark_Agent",
	"content":"-- ******************************************************************** --\n-- author: jh_caiyi\n-- create time: 2025-07-15\n-- descr:智慧物流系统专线-销售合同数据明细\n-- sls_productlogistics_salescontract\n-- ******************************************************************** --\n-- DROP TABLE IF EXISTS dwi_log.dwi_log_lz_sls_productlogistics_salescontract;\n-- CREATE TABLE\n-- dwi_log.dwi_log_lz_sls_productlogistics_salescontract (\n-- compid varchar(10) COMMENT '公司别,',\n-- orderno varchar(15) COMMENT '订单编号,',\n-- ordered varchar(2) COMMENT '订单变更版次,',\n-- quotationno varchar(15) COMMENT '报价单号,',\n-- contractno varchar(15) COMMENT '合同编号,',\n-- newprodno varchar(15) COMMENT '合同评审单号,',\n-- custno varchar(30) COMMENT '客户编号,',\n-- directsale varchar(1) COMMENT '是否为直销客户,',\n-- custcategory varchar(1) COMMENT '客户分类,',\n-- custclassify varchar(1) COMMENT '客户分级,',\n-- custpurchaseno varchar(30) COMMENT '客户采购案号,',\n-- prodpriority varchar(1) COMMENT '生产优先级,',\n-- salestype varchar(2) COMMENT '销售方式(画面显示用),',\n-- inoutsale varchar(2) COMMENT '内外销别(系统内部用),',\n-- factory varchar(5) COMMENT '生产厂,',\n-- salesunit varchar(2) COMMENT '销售单位,',\n-- salesorg varchar(2) COMMENT '销售组别(销售部门),',\n-- prodclass varchar(1) COMMENT '产品大类,',\n-- prodtype varchar(5) COMMENT '产品型态,',\n-- salesmanno varchar(8) COMMENT '销售人员,',\n-- orderkind varchar(2) COMMENT '订货方式,',\n-- countwgtmode varchar(1) COMMENT '计重方式,',\n-- tradeterm varchar(10) COMMENT '贸易条件,',\n-- tradetermremark varchar(20) COMMENT 'TradeTerm说明,',\n-- paymentterm varchar(5) COMMENT 'PaymentTerm,',\n-- payday decimal(3, 0) COMMENT '付款天数(days),',\n-- fullpay varchar(1) COMMENT '是否为全额缴款,',\n-- paycent decimal(5, 2) COMMENT '预付款,',\n-- crcy varchar(10) COMMENT '币别,',\n-- taxtype varchar(2) COMMENT '税别,',\n-- taxrate decimal(5, 2) COMMENT '税率,',\n-- discount varchar(50) COMMENT '折扣优惠,',\n-- ordermonth varchar(6) COMMENT '销售月份,',\n-- ordercredate varchar(8) COMMENT '订单建立日期,',\n-- shippeddate varchar(8) COMMENT '预定交期,',\n-- transtype varchar(2) COMMENT '运输方式,',\n-- freightunit varchar(1) COMMENT '运费担当,',\n-- bracetype varchar(1) COMMENT '支架运输方式,',\n-- packway varchar(1) COMMENT '装载方式,',\n-- cartype varchar(3) COMMENT '车型,',\n-- freightcustno varchar(30) COMMENT '抵扣单位,',\n-- recno varchar(5) COMMENT '收货序号,',\n-- endlocno varchar(20) COMMENT '终到地区,',\n-- innerorder varchar(5) COMMENT '自提锁定状态,',\n-- creempno varchar(8) COMMENT '新增人员,',\n-- credate varchar(8) COMMENT '新增日期,',\n-- uptempno varchar(8) COMMENT '修改人员,',\n-- uptdate varchar(8) COMMENT '修改日期,',\n-- orderstatus varchar(2) COMMENT '订单状态,',\n-- schprodmode varchar(1) COMMENT '螺纹钢转运加价（提单用）,',\n-- saleregion varchar(3) COMMENT '销售区域,',\n-- areano varchar(3) COMMENT '销售地区,',\n-- locationno varchar(10) COMMENT '地点代码,',\n-- custline varchar(10) COMMENT '专用线,',\n-- recname varchar(50) COMMENT '收货人名称,',\n-- capitalcustomer varchar(1) COMMENT '列名大户,',\n-- company varchar(5) COMMENT '入单公司,',\n-- prepaycent decimal(5, 2) COMMENT '原预付款,',\n-- salesinvoicetype varchar(1) COMMENT '发票类型,',\n-- carcompid varchar(6) COMMENT '运输单位,',\n-- pricec decimal(9, 4) COMMENT '运费单价(南钢办理运费),',\n-- importantcustomer varchar(1) COMMENT '重点客户,',\n-- priceca decimal(9, 4) COMMENT '一票制运输价格,',\n-- pricecb decimal(9, 4) COMMENT '一票制加工业务价格,',\n-- isjit varchar(1) COMMENT '定制配送,',\n-- pricepolicy varchar(1) COMMENT '价格政策,',\n-- contractmonth varchar(6) COMMENT '合同月份,',\n-- salesorgm varchar(30) COMMENT '销售所属部门,',\n-- transcontractno varchar(20) COMMENT '发货运输合同号,',\n-- freightprice decimal(9, 4) COMMENT '运费单价(发货运输合同),',\n-- searchrevision varchar(14) COMMENT '询价版次,',\n-- subcustno varchar(30) COMMENT '子公司客户编号,',\n-- weixinno varchar(30) COMMENT '微信评审号,',\n-- projectname varchar(80) COMMENT '长单项目名称,',\n-- isall varchar(1) COMMENT '是否整单交付,',\n-- stockid varchar(5) COMMENT '发货仓库,',\n-- jmdept varchar(2) COMMENT '金贸部室,',\n-- ismachine varchar(1) COMMENT '是否工程机械用钢,',\n-- machinegrade varchar(2) COMMENT '工程机械用钢级别,',\n-- nextcustno varchar(30) COMMENT '下游客户编号,',\n-- isnew varchar(1) COMMENT '是否走新质量设计,',\n-- isqs varchar(1) COMMENT '是否电商系统,',\n-- isjc varchar(1) COMMENT '是否复合板基材,',\n-- carcompidtwo varchar(8) COMMENT '二级运输单位,',\n-- iscontractno varchar(1) COMMENT '是否无合同号,',\n-- flda varchar(60) COMMENT '预留一,',\n-- fldb varchar(60) COMMENT '预留二,',\n-- fldc varchar(60) COMMENT '预留三,',\n-- fldd varchar(60) COMMENT '预留四,',\n-- flde varchar(500) COMMENT '预留五,',\n-- fldf varchar(60) COMMENT '预留六,',\n-- fldg varchar(60) COMMENT '预留七,',\n-- fldh varchar(60) COMMENT '预留八,',\n-- fldi varchar(60) COMMENT '预留九,',\n-- fldj varchar(60) COMMENT '预留十,',\n-- fldk varchar(60) COMMENT '预留十一,',\n-- fldl varchar(60) COMMENT '预留十二,',\n-- fldm varchar(60) COMMENT '预留十三,',\n-- fldn varchar(500) COMMENT '预留十四,',\n-- isquaprice varchar(1) COMMENT '是否获取新运费单价,',\n-- longorderno varchar(15) COMMENT '长单编号,',\n-- islongorder varchar(2) COMMENT '是否长单,',\n-- iscrecontract varchar(1) COMMENT '是否自动生成合同,',\n-- cretime varchar(8) COMMENT '订单创建时间,',\n-- pricetype varchar(1) COMMENT '网价类型,',\n-- qklcustno varchar(6) COMMENT '区块链订单客户号,',\n-- exchangerate decimal(5, 4) COMMENT '汇率,',\n-- forcurrency varchar(50) COMMENT '外币币种,',\n-- nbuserno varchar(8) COMMENT '南北erp业务员工号,',\n-- newfullpay varchar(1) COMMENT '自定义全额缴款,',\n-- subcustname varchar(100) COMMENT '子公司客户名称,',\n-- etl_date DATE COMMENT 'ETL时间'\n-- )\n-- COMMENT '廉政八项-智慧物流系统专线-销售合同数据明细'\n-- STORED AS ORC;\n\nINSERT OVERWRITE TABLE\ndwi_log.dwi_log_lz_sls_productlogistics_salescontract\nSELECT \n    compid,\n    orderno,\n    ordered,\n    quotationno,\n    contractno,\n    newprodno,\n    custno,\n    directsale,\n    custcategory,\n    custclassify,\n    custpurchaseno,\n    prodpriority,\n    salestype,\n    inoutsale,\n    factory,\n    salesunit,\n    salesorg,\n    prodclass,\n    prodtype,\n    salesmanno,\n    orderkind,\n    countwgtmode,\n    tradeterm,\n    tradetermremark,\n    paymentterm,\n    payday,\n    fullpay,\n    paycent,\n    crcy,\n    taxtype,\n    taxrate,\n    discount,\n    ordermonth,\n    ordercredate,\n    shippeddate,\n    transtype,\n    freightunit,\n    bracetype,\n    packway,\n    cartype,\n    freightcustno,\n    recno,\n    endlocno,\n    innerorder,\n    creempno,\n    credate,\n    uptempno,\n    uptdate,\n    orderstatus,\n    schprodmode,\n    saleregion,\n    areano,\n    locationno,\n    custline,\n    recname,\n    capitalcustomer,\n    company,\n    prepaycent,\n    salesinvoicetype,\n    carcompid,\n    pricec,\n    importantcustomer,\n    priceca,\n    pricecb,\n    isjit,\n    pricepolicy,\n    contractmonth,\n    salesorgm,\n    transcontractno,\n    freightprice,\n    searchrevision,\n    subcustno,\n    weixinno,\n    projectname,\n    isall,\n    stockid,\n    jmdept,\n    ismachine,\n    machinegrade,\n    nextcustno,\n    isnew,\n    isqs,\n    isjc,\n    carcompidtwo,\n    iscontractno,\n    flda,\n    fldb,\n    fldc,\n    fldd,\n    flde,\n    fldf,\n    fldg,\n    fldh,\n    fldi,\n    fldj,\n    fldk,\n    fldl,\n    fldm,\n    fldn,\n    isquaprice,\n    longorderno,\n    islongorder,\n    iscrecontract,\n    cretime,\n    pricetype,\n    qklcustno,\n    exchangerate,\n    forcurrency,\n    nbuserno,\n    newfullpay,\n    subcustname,\n    CURRENT_DATE() AS etl_date\nFROM \n    dwi_log.dwi_log_tbsonj011;\n",
	"currentDatabase":"dwi_log",
	"description":"",
	"directory":"/廉政专项/智慧物流/明细表",
	"encrypt":false,
	"name":"etl_dwi_lz_sls_productlogistics_salescontract",
	"templateVersion":"1.0",
	"type":"SparkSQL"
}